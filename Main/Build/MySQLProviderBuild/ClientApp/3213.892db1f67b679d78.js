"use strict";(self.webpackChunkposadminportal=self.webpackChunkposadminportal||[]).push([[3213],{3213:(Kr,P,i)=>{i.r(P),i.d(P,{SaleOrderReturnModule:()=>kr});var d=i(9808),_=i(2554),S=i(319),M=i(9147),B=i(4835),$=i(8394),V=i(3349),ot=i(7286),p=i(1777),c=i(3075),v=i(6087),Z=i(4847),R=i(708),h=i(2),at=i(8929),it=i(6787),st=i(567),g=i(13),f=i(5778),T=i(7545),N=i(2868),D=i(1490),lt=i(3085),ct=i(931),ut=i(1739),t=i(5e3),L=i(838),H=i(1781),dt=i(5485),k=i(2290),I=i(6107),G=i(2349),X=i(8265),z=i(9785),U=i(226),mt=i(6717),b=i(508),C=i(2181),y=i(5245),E=i(7423),q=i(1079),A=i(773),l=i(2075),Q=i(8708),Y=i(1062);function _t(e,n){1&e&&(t.TgZ(0,"div",21),t._UZ(1,"mat-spinner"),t.qZA())}function pt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PRODUCT_NAME")))}function ht(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",r.productName," ")}}function gt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SOURCE")))}function ft(e,n){1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SALES_ORDER_RETURN")," "))}function xt(e,n){1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SALES_ORDER")," "))}function Tt(e,n){if(1&e&&(t.TgZ(0,"td",23),t.YNc(1,ft,3,3,"ng-container",24),t.YNc(2,xt,3,3,"ng-container",24),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngIf",1===r.status),t.xp6(1),t.Q6J("ngIf",1!==r.status)}}function Ot(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT")," "))}function Zt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",r.unitName," ")}}function Ct(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT_PER_PRICE")," "))}function At(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.unitPrice)," ")}}function St(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY")," "))}function vt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",1===r.status?-1*r.quantity:r.quantity," ")}}function Rt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_DISCOUNT")," "))}function Nt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,r.discount),"(",r.discountPercentage,"%) ")}}function Dt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TAX")," "))}function Lt(e,n){1&e&&(t.TgZ(0,"span"),t._uU(1," ,"),t.qZA())}function It(e,n){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,Lt,2,0,"span",24),t.qZA()),2&e){const r=n.$implicit,o=n.last;t.xp6(1),t.AsE(" ",r.taxName,"(",r.taxPercentage,"%) "),t.xp6(1),t.Q6J("ngIf",!o)}}function Ut(e,n){if(1&e&&(t.TgZ(0,"td",23),t.YNc(1,It,3,3,"span",25),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngForOf",r.salesOrderItemTaxes)}}function bt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_TAX")," "))}function yt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.taxValue)," ")}}function Et(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL")," "))}function qt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.unitPrice*r.quantity-r.discount+r.taxValue)," ")}}function Qt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"WAREHOUSE"),""))}function Yt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",r.warehouseName," ")}}function Ft(e,n){1&e&&t._UZ(0,"tr",26)}function Jt(e,n){1&e&&t._UZ(0,"tr",27)}let wt=(()=>{class e extends D.H{constructor(r,o){super(o),this.salesOrderService=r,this.translationService=o,this.salesOrderItems=[],this.isLoading=!1,this.displayedColumns=["productName","source","unitName","unitPrice","quantity","totalDiscount","taxes","totalTax","totalAmount","warehouse"],this.getLangDir()}ngOnInit(){}ngOnChanges(r){r.salesOrder&&this.getSalesOrderItems()}getSalesOrderItems(){this.isLoading=!0,this.salesOrderService.getSalesOrderItems(this.salesOrder.id,!0).subscribe(r=>{this.isLoading=!1,this.salesOrderItems=r},()=>this.isLoading=!1)}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(L.V),t.Y36(I.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sale-order-return-item"]],inputs:{salesOrder:"salesOrder"},features:[t.qOj,t.TTD],decls:42,vars:9,consts:[[1,"page-header-main"],[1,"row","align-items-center"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","loading-shade",4,"ngIf"],[1,"table-responsive"],["mat-table","",1,"table","table-bordered","table-hover",3,"dir","dataSource"],["matColumnDef","productName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","source"],["matColumnDef","unitName"],["matColumnDef","unitPrice"],["matColumnDef","quantity"],["matColumnDef","totalDiscount"],["matColumnDef","taxes"],["matColumnDef","totalTax"],["matColumnDef","totalAmount"],["matColumnDef","warehouse"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"loading-shade"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row",""]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()(),t.YNc(7,_t,2,0,"div",4),t.TgZ(8,"div",5)(9,"table",6),t.ynx(10,7),t.YNc(11,pt,3,3,"th",8),t.YNc(12,ht,2,1,"td",9),t.BQk(),t.ynx(13,10),t.YNc(14,gt,3,3,"th",8),t.YNc(15,Tt,3,2,"td",9),t.BQk(),t.ynx(16,11),t.YNc(17,Ot,3,3,"th",8),t.YNc(18,Zt,2,1,"td",9),t.BQk(),t.ynx(19,12),t.YNc(20,Ct,3,3,"th",8),t.YNc(21,At,3,3,"td",9),t.BQk(),t.ynx(22,13),t.YNc(23,St,3,3,"th",8),t.YNc(24,vt,2,1,"td",9),t.BQk(),t.ynx(25,14),t.YNc(26,Rt,3,3,"th",8),t.YNc(27,Nt,3,4,"td",9),t.BQk(),t.ynx(28,15),t.YNc(29,Dt,3,3,"th",8),t.YNc(30,Ut,2,1,"td",9),t.BQk(),t.ynx(31,16),t.YNc(32,bt,3,3,"th",8),t.YNc(33,yt,3,3,"td",9),t.BQk(),t.ynx(34,17),t.YNc(35,Et,3,3,"th",8),t.YNc(36,qt,3,3,"td",9),t.BQk(),t.ynx(37,18),t.YNc(38,Qt,3,3,"th",8),t.YNc(39,Yt,2,1,"td",9),t.BQk(),t.YNc(40,Ft,1,0,"tr",19),t.YNc(41,Jt,1,0,"tr",20),t.qZA()()),2&r&&(t.xp6(5),t.Oqu(t.lcZ(6,7,"SALES_ORDER_ITEMS")),t.xp6(2),t.Q6J("ngIf",o.isLoading),t.xp6(2),t.Q6J("dir",o.langDir)("dataSource",o.salesOrderItems),t.xp6(31),t.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns))},dependencies:[d.sg,d.O5,U.Lv,A.Ou,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.ge,l.ev,l.XQ,l.Gk,Q.R,Y.X$]}),e})();var jt=i(8017),Pt=i(2989);const Mt=function(){return["/sales-order-return/add"]};function Bt(e,n){1&e&&(t.TgZ(0,"button",50),t._UZ(1,"i",51),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&e&&(t.Q6J("routerLink",t.DdM(4,Mt)),t.xp6(2),t.hij(" ",t.lcZ(3,2,"ADD_SALES_ORDER_RETURN")," "))}function $t(e,n){1&e&&(t.TgZ(0,"div",52),t._UZ(1,"mat-spinner"),t.qZA())}function Vt(e,n){1&e&&t._UZ(0,"th",53)}function Ht(e,n){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"chevron_right"),t.qZA())}function kt(e,n){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_more"),t.qZA())}function Gt(e,n){if(1&e&&(t.TgZ(0,"button",61)(1,"mat-icon"),t._uU(2,"more_vert"),t.qZA()()),2&e){t.oxw();const r=t.MAs(6);t.Q6J("matMenuTriggerFor",r)}}const K=function(e){return["/sales-order/detail",e]};function Xt(e,n){if(1&e&&(t.TgZ(0,"button",62)(1,"mat-icon"),t._uU(2,"info"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&e){const r=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(4,K,r.id)),t.xp6(4),t.Oqu(t.lcZ(5,2,"DETAIL"))}}function zt(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(r);const a=t.oxw(2).$implicit,s=t.oxw();return t.KtG(s.addPayment(a))}),t.TgZ(1,"mat-icon"),t._uU(2,"payment"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"ADD_PAYMENT")))}function Kt(e,n){1&e&&(t.TgZ(0,"ng-contaner"),t.YNc(1,zt,6,3,"button",60),t.qZA()),2&e&&(t.xp6(1),t.Q6J("hasClaim","SO_ADD_SO_PAYMENT"))}function Wt(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(r);const a=t.oxw().$implicit,s=t.oxw();return t.KtG(s.viewPayment(a))}),t.TgZ(1,"mat-icon"),t._uU(2,"view_carousel"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"VIEW_PAYMENT")))}function te(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",63),t.NdJ("click",function(){t.CHM(r);const a=t.oxw().$implicit,s=t.oxw();return t.KtG(s.generateInvoice(a))}),t.TgZ(1,"mat-icon"),t._uU(2,"receipt"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"GENERATE_INVOICE")))}const ee=function(){return["SO_UPDATE_SO","SO_VIEW_SO_DETAIL","SO_DELETE_SO","SO_RETURN_SO","SO_ADD_SO_PAYMENT","SO_VIEW_SO_PAYMENTS","SO_GENERATE_INVOICE"]};function re(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"td",54)(1,"button",55),t.NdJ("click",function(){const s=t.CHM(r).$implicit,u=t.oxw();return t.KtG(u.toggleRow(s))}),t.YNc(2,Ht,2,0,"mat-icon",49),t.YNc(3,kt,2,0,"mat-icon",49),t.qZA(),t.YNc(4,Gt,3,1,"button",56),t.TgZ(5,"mat-menu",57,58),t.YNc(7,Xt,6,6,"button",59),t.YNc(8,Kt,2,1,"ng-contaner",49),t.YNc(9,Wt,6,3,"button",60),t.YNc(10,te,6,3,"button",60),t.qZA()()}if(2&e){const r=n.$implicit,o=t.oxw();t.xp6(2),t.Q6J("ngIf",r!=o.expandedElement),t.xp6(1),t.Q6J("ngIf",r==o.expandedElement),t.xp6(1),t.Q6J("hasClaim",t.DdM(8,ee)),t.xp6(1),t.Q6J("dir",o.langDir),t.xp6(2),t.Q6J("hasClaim","SO_VIEW_SO_DETAIL"),t.xp6(1),t.Q6J("ngIf",0!=r.paymentStatus),t.xp6(1),t.Q6J("hasClaim","SO_VIEW_SO_PAYMENTS"),t.xp6(1),t.Q6J("hasClaim","SO_GENERATE_INVOICE")}}function ne(e,n){1&e&&(t.TgZ(0,"th",64),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CREATED_DATE")," "))}function oe(e,n){if(1&e&&(t.TgZ(0,"td",65),t._uU(1),t.ALo(2,"utcToLocalTime"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.soCreatedDate,"shortDate")," ")}}function ae(e,n){1&e&&(t.TgZ(0,"th",66),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"ORDER_NUMBER")," "))}function ie(e,n){if(1&e&&(t.TgZ(0,"td",54)(1,"a",67),t._uU(2),t.qZA()()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,K,r.id)),t.xp6(1),t.hij("",r.orderNumber," ")}}function se(e,n){1&e&&(t.TgZ(0,"th",66),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DELIVERY_DATE")," "))}function le(e,n){if(1&e&&(t.TgZ(0,"td",65),t._uU(1),t.ALo(2,"utcToLocalTime"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.deliveryDate,"shortDate")," ")}}function ce(e,n){1&e&&(t.TgZ(0,"th",68),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij("",t.lcZ(2,1,"CUSTOMER_NAME")," "))}const ue=function(e){return["/customer",e]};function de(e,n){if(1&e&&(t.TgZ(0,"td",69)(1,"a",67),t._uU(2),t.qZA()()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,ue,r.customerId)),t.xp6(1),t.hij(" ",r.customerName," ")}}function me(e,n){1&e&&(t.TgZ(0,"th",70),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_DISCOUNT")," "))}function _e(e,n){if(1&e&&(t.TgZ(0,"td",71),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalDiscount)," ")}}function pe(e,n){1&e&&(t.TgZ(0,"th",70),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_TAX")," "))}function he(e,n){if(1&e&&(t.TgZ(0,"td",71),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalTax)," ")}}function ge(e,n){1&e&&(t.TgZ(0,"th",70),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_AMOUNT")," "))}function fe(e,n){if(1&e&&(t.TgZ(0,"td",71),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalAmount)," ")}}function xe(e,n){1&e&&(t.TgZ(0,"th",70),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_PAID_AMOUNT")," "))}function Te(e,n){if(1&e&&(t.TgZ(0,"td",71),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalPaidAmount)," ")}}function Oe(e,n){1&e&&(t.TgZ(0,"th",70),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENT_STATUS")," "))}const Ze=function(e,n,r){return{"badge-success":e,"badge-danger":n,"badge-warning":r}};function Ce(e,n){if(1&e&&(t.TgZ(0,"td",72)(1,"span",73),t._uU(2),t.ALo(3,"paymentStatus"),t.qZA()()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngClass",t.kEZ(4,Ze,0==r.paymentStatus,1==r.paymentStatus,2==r.paymentStatus)),t.xp6(1),t.Oqu(t.lcZ(3,2,r.paymentStatus))}}function Ae(e,n){1&e&&t._UZ(0,"th",74)}function Se(e,n){1&e&&t._UZ(0,"th",74)}function ve(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"th",74)(1,"input",75),t.NdJ("ngModelChange",function(a){t.CHM(r);const s=t.oxw();return t.KtG(s.OrderNumberFilter=a)}),t.ALo(2,"translate"),t.qZA()()}if(2&e){const r=t.oxw();t.xp6(1),t.s9C("placeholder",t.lcZ(2,2,"ORDER_NO")),t.Q6J("ngModel",r.OrderNumberFilter)}}function Re(e,n){1&e&&t._UZ(0,"th",74)}function Ne(e,n){if(1&e&&(t.TgZ(0,"mat-option",81),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.Q6J("value",r.customerName),t.xp6(1),t.hij(" ",r.customerName," ")}}function De(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"th",74),t._UZ(1,"input",76),t.ALo(2,"translate"),t.TgZ(3,"mat-autocomplete",77,78),t.NdJ("optionSelected",function(a){t.CHM(r);const s=t.oxw();return t.KtG(s.CustomerFilter=a.option.value)}),t.TgZ(5,"mat-option",79),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.YNc(8,Ne,2,2,"mat-option",80),t.ALo(9,"async"),t.qZA()()}if(2&e){const r=t.MAs(4),o=t.oxw();t.xp6(1),t.s9C("placeholder",t.lcZ(2,8,"CUSTOMER")),t.Q6J("formControl",o.customerNameControl)("matAutocomplete",r),t.xp6(2),t.Q6J("dir",o.langDir)("autoActiveFirstOption",!0),t.xp6(2),t.Q6J("dir",o.langDir),t.xp6(1),t.Oqu(t.lcZ(7,10,"NONE")),t.xp6(2),t.Q6J("ngForOf",t.lcZ(9,12,o.customerList$))}}function Le(e,n){1&e&&t._UZ(0,"th",74)}function Ie(e,n){1&e&&t._UZ(0,"th",74)}function Ue(e,n){1&e&&t._UZ(0,"th",74)}function be(e,n){1&e&&t._UZ(0,"th",74)}function ye(e,n){1&e&&t._UZ(0,"th",74)}const Ee=function(){return[10,20,30]};function qe(e,n){if(1&e&&(t.TgZ(0,"td",82),t._UZ(1,"mat-paginator",83),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("length",r.salesOrderResource.totalCount)("pageSize",r.salesOrderResource.pageSize)("pageSizeOptions",t.DdM(3,Ee))}}function Qe(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"div",84)(2,"div",85),t._UZ(3,"app-sale-order-return-item",86),t.qZA()(),t.BQk()),2&e){const r=t.oxw().$implicit,o=t.oxw();t.xp6(1),t.Q6J("@detailExpand",r==o.expandedElement?"expanded":"collapsed"),t.xp6(2),t.Q6J("salesOrder",r)}}function Ye(e,n){if(1&e&&(t.TgZ(0,"td",71),t.YNc(1,Qe,4,2,"ng-container",49),t.qZA()),2&e){const r=n.$implicit,o=t.oxw();t.uIk("colspan",o.displayedColumns.length),t.xp6(1),t.Q6J("ngIf",r==o.expandedElement)}}function Fe(e,n){1&e&&(t.TgZ(0,"tr")(1,"td",87)(2,"span",88)(3,"b"),t._uU(4),t.ALo(5,"translate"),t.qZA()()()()),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"NO_DATA_FOUND"),""))}function Je(e,n){1&e&&t._UZ(0,"tr",89)}function we(e,n){1&e&&t._UZ(0,"tr",90)}function je(e,n){1&e&&t._UZ(0,"tr",89)}function Pe(e,n){1&e&&t._UZ(0,"tr",91)}function Me(e,n){1&e&&t._UZ(0,"tr",92)}function Be(e,n){if(1&e&&(t.ynx(0),t._UZ(1,"app-sales-order-invoice",86),t.BQk()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("salesOrder",r.salesOrderForInvoice)}}const $e=function(){return["expandedDetail"]};let Ve=(()=>{class e extends D.H{constructor(r,o,a,s,u,m,x,w,j){super(x),this.salesOrderService=r,this.customerService=o,this.cd=a,this.commonDialogService=s,this.toastrService=u,this.router=m,this.translationService=x,this.dialog=w,this.clonerService=j,this.salesOrders=[],this.displayedColumns=["action","soCreatedDate","orderNumber","deliveryDate","customerName","totalDiscount","totalTax","totalAmount","totalPaidAmount","paymentStatus"],this.filterColumns=["action-search","soCreatedDate-search","orderNumber-search","deliverDate-search","customer-search","totalAmount-search","totalDiscount-search","totalTax-search","totalPaidAmount-search","paymentStatus-search"],this.footerToDisplayed=["footer"],this.isLoadingResults=!0,this.customerNameControl=new c.p4,this.filterObservable$=new at.xQ,this.getLangDir(),this.salesOrderResource=new R.e,this.salesOrderResource.pageSize=50,this.salesOrderResource.orderBy="soCreatedDate asc",this.salesOrderResource.status=h.q.Return}get CustomerFilter(){return this._customerFilter}set CustomerFilter(r){this._customerFilter=r,this.filterObservable$.next(`customerName:${r}`)}get OrderNumberFilter(){return this._orderNumberFilter}set OrderNumberFilter(r){this._orderNumberFilter=r,this.filterObservable$.next(`orderNumber:${r}`)}ngOnInit(){this.customerNameControlOnChange(),this.dataSource=new ct.X(this.salesOrderService),this.dataSource.loadData(this.salesOrderResource),this.getResourceParameter(),this.sub$.sink=this.filterObservable$.pipe((0,g.b)(1e3),(0,f.x)()).subscribe(r=>{this.salesOrderResource.skip=0,this.paginator.pageIndex=0;const o=r.split(":");"customerName"===o[0]?this.salesOrderResource.customerName=o[1]:"orderNumber"===o[0]&&(this.salesOrderResource.orderNumber=o[1]),this.dataSource.loadData(this.salesOrderResource)})}customerNameControlOnChange(){this.customerList$=this.customerNameControl.valueChanges.pipe((0,g.b)(1e3),(0,f.x)(),(0,T.w)(r=>this.customerService.getCustomersForDropDown("CustomerName",r)))}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,it.T)(this.sort.sortChange,this.paginator.page).pipe((0,N.b)(r=>{this.salesOrderResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.salesOrderResource.pageSize=this.paginator.pageSize,this.salesOrderResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadData(this.salesOrderResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(r=>{r&&(this.salesOrderResource.pageSize=r.pageSize,this.salesOrderResource.skip=r.skip,this.salesOrderResource.totalCount=r.totalCount)})}toggleRow(r){this.expandedElement=this.expandedElement===r?null:r,this.cd.detectChanges()}deleteSalesOrder(r){this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(o=>{o&&this.salesOrderService.deleteSalesOrder(r.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("SALES_ORDER_DELETED_SUCCESSFULLY")),this.dataSource.loadData(this.salesOrderResource)})})}addPayment(r){this.dialog.open(lt.J,{width:"100vh",direction:this.langDir,data:Object.assign({},r)}).afterClosed().subscribe(a=>{a&&this.dataSource.loadData(this.salesOrderResource)})}viewPayment(r){this.dialog.open(ut.G,{data:Object.assign({},r),direction:this.langDir}).afterClosed().subscribe(a=>{a&&this.dataSource.loadData(this.salesOrderResource)})}onSaleOrderReturn(r){this.router.navigate(["sales-order-return",r.id])}generateInvoice(r){let o=this.clonerService.deepClone(r);const a=this.customerService.getCustomer(r.customerId),s=this.salesOrderService.getSalesOrderItems(r.id);(0,st.D)({getCustomerRequest:a,getSalesOrderItems:s}).subscribe(u=>{o.customer=u.getCustomerRequest,o.salesOrderItems=u.getSalesOrderItems,this.salesOrderForInvoice=o})}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(L.V),t.Y36(H.v),t.Y36(t.sBO),t.Y36(dt.V),t.Y36(k._W),t.Y36(_.F0),t.Y36(I.D),t.Y36(G.uw),t.Y36(X.$))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sale-order-return-list"]],viewQuery:function(r,o){if(1&r&&(t.Gf(v.NW,5),t.Gf(Z.YE,5)),2&r){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first),t.iGM(a=t.CRH())&&(o.sort=a.first)}},features:[t.qOj],decls:76,vars:19,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","btn blue-btn btn-sm m-right-10",3,"routerLink",4,"hasClaim"],["class","loading-shade",4,"ngIf"],[1,"row"],[1,"col-sm-12"],[1,"table-responsive"],["mat-table","","multiTemplateDataRows","","matSort","","matSortActive","soCreatedDate",1,"table","table-bordered","table-hover","grid-height",3,"dir","dataSource"],["matColumnDef","action"],["class","table-column-150","mat-header-cell","",4,"matHeaderCellDef"],["class","table-column-150","mat-cell","",4,"matCellDef"],["matColumnDef","soCreatedDate"],["class","table-column-100","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-100","mat-cell","",4,"matCellDef"],["matColumnDef","orderNumber"],["class","table-column-150","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","deliveryDate"],["matColumnDef","customerName"],["class","table-column-300","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-300","mat-cell","",4,"matCellDef"],["matColumnDef","totalDiscount"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","totalTax"],["matColumnDef","totalAmount"],["matColumnDef","totalPaidAmount"],["matColumnDef","paymentStatus"],["mat-cell","","style","text-align: center;",4,"matCellDef"],["matColumnDef","action-search"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","soCreatedDate-search"],["matColumnDef","orderNumber-search"],["matColumnDef","deliverDate-search"],["matColumnDef","customer-search"],["matColumnDef","totalAmount-search"],["matColumnDef","totalDiscount-search"],["matColumnDef","totalTax-search"],["matColumnDef","totalPaidAmount-search"],["matColumnDef","paymentStatus-search"],["matColumnDef","footer"],["mat-footer-cell","","colspan","12",4,"matFooterCellDef"],["matColumnDef","expandedDetail"],[4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[1,"btn","blue-btn","btn-sm","m-right-10",3,"routerLink"],[1,"fas","fa-plus"],[1,"loading-shade"],["mat-header-cell","",1,"table-column-150"],["mat-cell","",1,"table-column-150"],["mat-icon-button","",3,"click"],["class","ml-4","mat-icon-button","","aria-label","Action",3,"matMenuTriggerFor",4,"hasClaim"],[3,"dir"],["menu","matMenu"],["mat-menu-item","",3,"routerLink",4,"hasClaim"],["mat-menu-item","",3,"click",4,"hasClaim"],["mat-icon-button","","aria-label","Action",1,"ml-4",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-header-cell","","mat-sort-header","",1,"table-column-100"],["mat-cell","",1,"table-column-100"],["mat-header-cell","","mat-sort-header","",1,"table-column-150"],[3,"routerLink"],["mat-header-cell","","mat-sort-header","",1,"table-column-300"],["mat-cell","",1,"table-column-300"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",2,"text-align","center"],[1,"badge-pill",3,"ngClass"],["mat-header-cell",""],["type","text",1,"form-control","w-90",3,"placeholder","ngModel","ngModelChange"],["type","text",1,"form-control","w-90",3,"placeholder","formControl","matAutocomplete"],[3,"dir","autoActiveFirstOption","optionSelected"],["autoCustomer","matAutocomplete"],["value","",3,"dir"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-footer-cell","","colspan","12"],[3,"length","pageSize","pageSizeOptions"],[1,"example-element-detail"],[1,"inner-table","mat-elevation-z8"],[3,"salesOrder"],["colspan","8"],[1,"p-4","mt-4"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["mat-row","",1,"example-detail-row"]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"div",2),t.YNc(8,Bt,4,5,"button",4),t.qZA()()(),t.YNc(9,$t,2,0,"div",5),t.ALo(10,"async"),t.TgZ(11,"div",6)(12,"div",7)(13,"div",8)(14,"table",9),t.ynx(15,10),t.YNc(16,Vt,1,0,"th",11),t.YNc(17,re,11,9,"td",12),t.BQk(),t.ynx(18,13),t.YNc(19,ne,3,3,"th",14),t.YNc(20,oe,3,4,"td",15),t.BQk(),t.ynx(21,16),t.YNc(22,ae,3,3,"th",17),t.YNc(23,ie,3,4,"td",12),t.BQk(),t.ynx(24,18),t.YNc(25,se,3,3,"th",17),t.YNc(26,le,3,4,"td",15),t.BQk(),t.ynx(27,19),t.YNc(28,ce,3,3,"th",20),t.YNc(29,de,3,4,"td",21),t.BQk(),t.ynx(30,22),t.YNc(31,me,3,3,"th",23),t.YNc(32,_e,3,3,"td",24),t.BQk(),t.ynx(33,25),t.YNc(34,pe,3,3,"th",23),t.YNc(35,he,3,3,"td",24),t.BQk(),t.ynx(36,26),t.YNc(37,ge,3,3,"th",23),t.YNc(38,fe,3,3,"td",24),t.BQk(),t.ynx(39,27),t.YNc(40,xe,3,3,"th",23),t.YNc(41,Te,3,3,"td",24),t.BQk(),t.ynx(42,28),t.YNc(43,Oe,3,3,"th",23),t.YNc(44,Ce,4,8,"td",29),t.BQk(),t.ynx(45,30),t.YNc(46,Ae,1,0,"th",31),t.BQk(),t.ynx(47,32),t.YNc(48,Se,1,0,"th",31),t.BQk(),t.ynx(49,33),t.YNc(50,ve,3,4,"th",31),t.BQk(),t.ynx(51,34),t.YNc(52,Re,1,0,"th",31),t.BQk(),t.ynx(53,35),t.YNc(54,De,10,14,"th",31),t.BQk(),t.ynx(55,36),t.YNc(56,Le,1,0,"th",31),t.BQk(),t.ynx(57,37),t.YNc(58,Ie,1,0,"th",31),t.BQk(),t.ynx(59,38),t.YNc(60,Ue,1,0,"th",31),t.BQk(),t.ynx(61,39),t.YNc(62,be,1,0,"th",31),t.BQk(),t.ynx(63,40),t.YNc(64,ye,1,0,"th",31),t.BQk(),t.ynx(65,41),t.YNc(66,qe,2,4,"td",42),t.BQk(),t.ynx(67,43),t.YNc(68,Ye,2,2,"td",24),t.BQk(),t.YNc(69,Fe,6,3,"tr",44),t.YNc(70,Je,1,0,"tr",45),t.YNc(71,we,1,0,"tr",46),t.YNc(72,je,1,0,"tr",45),t.YNc(73,Pe,1,0,"tr",47),t.YNc(74,Me,1,0,"tr",48),t.qZA()()()(),t.YNc(75,Be,2,1,"ng-container",49)),2&r&&(t.xp6(5),t.Oqu(t.lcZ(6,14,"SALES_ORDER_RETURN")),t.xp6(3),t.Q6J("hasClaim","SORE_ADD_SORE"),t.xp6(1),t.Q6J("ngIf",t.lcZ(10,16,o.dataSource.loading$)),t.xp6(5),t.Q6J("dir",o.langDir)("dataSource",o.dataSource),t.xp6(56),t.Q6J("matHeaderRowDef",o.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("matHeaderRowDef",o.filterColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matFooterRowDef",o.footerToDisplayed)("matFooterRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(18,$e)),t.xp6(1),t.Q6J("ngIf",o.salesOrderForInvoice))},dependencies:[d.mk,d.sg,d.O5,_.rH,_.yS,c.Fj,c.JJ,c.On,c.oH,z.d,U.Lv,mt.Y,b.ey,C.VK,C.OP,C.p6,y.Hw,E.lW,q.XC,q.ZL,A.Ou,l.BZ,l.fO,l.as,l.w1,l.Dz,l.nj,l.mD,l.Ke,l.ge,l.ev,l.yh,l.XQ,l.Gk,l.Q2,l.Ee,v.NW,Z.YE,Z.nU,wt,d.Ov,Q.R,jt.M,Y.X$,Pt.r],data:{animation:[(0,p.X$)("detailExpand",[(0,p.SB)("collapsed",(0,p.oB)({height:"0px",minHeight:"0"})),(0,p.SB)("expanded",(0,p.oB)({height:"*"})),(0,p.eR)("expanded <=> collapsed",(0,p.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),e})();var He=i(3231),ke=i(3007),Ge=i(796),F=i(6521),J=i(6695),Xe=i(6018),ze=i(5528),W=i(4107),O=i(1122),tt=i(4834);function Ke(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&e){const r=n.$implicit,o=t.oxw(2);t.Q6J("dir",o.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.customerName," ")}}function We(e,n){1&e&&(t.TgZ(0,"mat-option",19),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"NONE")))}function tr(e,n){1&e&&(t.TgZ(0,"mat-option",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NO_RECORDS")," "))}function er(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&e){const r=n.$implicit,o=t.oxw(2);t.Q6J("dir",o.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.orderNumber," ")}}function rr(e,n){1&e&&(t.TgZ(0,"mat-option",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NO_RECORDS")," "))}function nr(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"form",6)(2,"div",7)(3,"div",8)(4,"div",9)(5,"label"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",10)(9,"mat-select",11),t.ALo(10,"translate"),t._UZ(11,"input",12),t.ALo(12,"translate"),t._UZ(13,"mat-divider"),t.YNc(14,Ke,2,3,"mat-option",13),t.YNc(15,We,3,3,"mat-option",14),t.YNc(16,tr,3,3,"mat-option",15),t.qZA()()()(),t.TgZ(17,"div",8)(18,"div",9)(19,"label"),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"div",10)(23,"mat-select",16),t.ALo(24,"translate"),t._UZ(25,"input",17),t.ALo(26,"translate"),t._UZ(27,"mat-divider"),t.YNc(28,er,2,3,"mat-option",13),t.YNc(29,rr,3,3,"mat-option",15),t.qZA()()()()()(),t.BQk()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("formGroup",r.salesOrderReturnForm),t.xp6(5),t.Oqu(t.lcZ(7,14,"SELECT_CUSTOMER")),t.xp6(3),t.s9C("placeholder",t.lcZ(10,16,"SELECT_CUSTOMER")),t.Q6J("dir",r.langDir),t.xp6(2),t.s9C("placeholder",t.lcZ(12,18,"SEARCH_OTHER_CUSTOMERS")),t.xp6(3),t.Q6J("ngForOf",r.customersForSearch),t.xp6(1),t.Q6J("ngIf",r.customersForSearch.length>0),t.xp6(1),t.Q6J("ngIf",0==r.customersForSearch.length),t.xp6(4),t.hij("",t.lcZ(21,20,"SELECT_SALES_ORDER")," "),t.xp6(3),t.s9C("placeholder",t.lcZ(24,22,"SELECT_SALES_ORDER")),t.Q6J("dir",r.langDir),t.xp6(2),t.MGl("placeholder"," ",t.lcZ(26,24,"SEARCH_OTHER_SALES_ORDER"),""),t.xp6(3),t.Q6J("ngForOf",r.salesorders),t.xp6(1),t.Q6J("ngIf",0==r.salesorders.length)}}function or(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SO_ORDER_NUMBER_IS_REQUIRED")," "))}function ar(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,or,3,3,"div",56),t.qZA()),2&e){const r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("orderNumber").errors?null:r.salesOrderForm.get("orderNumber").errors.required)}}function ir(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"ORDER_DATE_IS_REQUIRED")," "))}function sr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,ir,3,3,"div",56),t.qZA()),2&e){const r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("soCreatedDate").errors?null:r.salesOrderForm.get("soCreatedDate").errors.required)}}function lr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DELIVERY_DATE_REQUIRED")," "))}function cr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,lr,3,3,"div",56),t.qZA()),2&e){const r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("deliveryDate").errors?null:r.salesOrderForm.get("deliveryDate").errors.required)}}function ur(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&e){const r=n.$implicit,o=t.oxw(2);t.Q6J("dir",o.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.customerName," ")}}function dr(e,n){1&e&&(t.TgZ(0,"mat-option",20),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NO_RECORDS")," "))}function mr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CUSTOMER_NAME_IS_REQUIRED")," "))}function _r(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,mr,3,3,"div",56),t.qZA()),2&e){const r=t.oxw(2);t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("customerId").errors?null:r.salesOrderForm.get("customerId").errors.required)}}function pr(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",69),t.NdJ("click",function(){t.CHM(r);const a=t.oxw().index,s=t.oxw(2);return t.KtG(s.onRemoveSalesOrderItem(a))}),t.TgZ(1,"mat-icon",70),t._uU(2,"delete_forever"),t.qZA()()}}function hr(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&e){const r=n.$implicit,o=t.oxw(3);t.Q6J("dir",o.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function gr(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e){const r=t.oxw(3);t.Q6J("dir",r.langDir),t.xp6(1),t.hij(" ",t.lcZ(2,2,"NO_RECORDS")," ")}}function fr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PRODUCT_IS_REQUIRED")," "))}function xr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,fr,3,3,"div",56),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("productId").errors?null:r.get("productId").errors.required)}}function Tr(e,n){if(1&e&&(t.TgZ(0,"mat-option",20),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.Q6J("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function Or(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&e){const r=n.$implicit,o=t.oxw(3);t.Q6J("dir",o.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function Zr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT_IS_REQUIRED")," "))}function Cr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Zr,3,3,"div",56),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("unitPrice").errors?null:r.get("unitPrice").errors.required)}}function Ar(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY_IS_REQUIRED")," "))}function Sr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Ar,3,3,"div",56),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("quantity").errors?null:r.get("quantity").errors.required)}}function vr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY_IS_REQUIRED")," "))}function Rr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY_IS_MAX")," "))}function Nr(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY_IS_MIN")," "))}function Dr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,vr,3,3,"div",56),t.YNc(2,Rr,3,3,"div",56),t.YNc(3,Nr,3,3,"div",56),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("returnquantity").errors?null:r.get("returnquantity").errors.required),t.xp6(1),t.Q6J("ngIf",null==r.get("returnquantity").errors?null:r.get("returnquantity").errors.max),t.xp6(1),t.Q6J("ngIf",null==r.get("returnquantity").errors?null:r.get("returnquantity").errors.min)}}function Lr(e,n){if(1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"customCurrency"),t.ALo(4,"quantitiesunitpriceTax"),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,"DISCOUNT_AMOUNT"),": ",t.lcZ(3,4,t.Dn7(4,6,r.get("returnquantity").value,r.get("unitPrice").value,r.get("discountPercentage").value))," ")}}function Ir(e,n){if(1&e&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&e){const r=n.$implicit,o=t.oxw(3);t.Q6J("dir",o.langDir)("value",r.id),t.xp6(1),t.AsE("",r.name," (",r.percentage,"%) ")}}function Ur(e,n){1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TAX_IS_REQUIRED")," "))}function br(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Ur,3,3,"div",56),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("taxValue").errors?null:r.get("taxValue").errors.required)}}const et=function(e,n,r,o,a){return[e,n,r,o,a]};function yr(e,n){if(1&e&&(t.TgZ(0,"div",23),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"customCurrency"),t.ALo(4,"quantitiesunitpriceTax"),t.qZA()),2&e){const r=t.oxw(),o=r.$implicit,a=r.index,s=t.oxw(2);t.xp6(1),t.AsE(" ",t.lcZ(2,2,"TAX_AMOUNT"),": ",t.lcZ(3,4,t.G7q(4,6,t.qbA(12,et,o.get("returnquantity").value,o.get("unitPrice").value,o.get("discountPercentage").value,o.get("taxValue").value,s.taxsMap[a])))," ")}}function Er(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"tr",57)(1,"td"),t.YNc(2,pr,3,0,"button",58),t.qZA(),t.TgZ(3,"td")(4,"mat-select",59),t.NdJ("selectionChange",function(a){const u=t.CHM(r).index,m=t.oxw(2);return t.KtG(m.onProductSelectionChange(a,u))}),t.ALo(5,"translate"),t._UZ(6,"mat-divider"),t.YNc(7,hr,2,3,"mat-option",13),t.YNc(8,gr,3,4,"mat-option",60),t.qZA(),t.YNc(9,xr,2,1,"div",4),t.qZA(),t.TgZ(10,"td")(11,"mat-select",61),t.YNc(12,Tr,2,2,"mat-option",62),t.qZA()(),t.TgZ(13,"td")(14,"mat-select",63),t.YNc(15,Or,2,3,"mat-option",13),t.qZA()(),t.TgZ(16,"td"),t._UZ(17,"input",64),t.ALo(18,"translate"),t.YNc(19,Cr,2,1,"div",4),t.qZA(),t.TgZ(20,"td"),t._UZ(21,"input",65),t.ALo(22,"translate"),t.YNc(23,Sr,2,1,"div",4),t.qZA(),t.TgZ(24,"td")(25,"input",66),t.NdJ("change",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.onQuantityChange())}),t.ALo(26,"translate"),t.qZA(),t.YNc(27,Dr,4,3,"div",4),t.qZA(),t.TgZ(28,"td"),t._uU(29),t.ALo(30,"customCurrency"),t.ALo(31,"quantitiesunitprice"),t.qZA(),t.TgZ(32,"td")(33,"input",67),t.NdJ("change",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.onDiscountChange())}),t.ALo(34,"translate"),t.qZA()(),t.TgZ(35,"td"),t._uU(36),t.ALo(37,"customCurrency"),t.ALo(38,"quantitiesunitprice"),t.YNc(39,Lr,5,10,"div",56),t.qZA(),t.TgZ(40,"td")(41,"mat-select",68),t.NdJ("selectionChange",function(){t.CHM(r);const a=t.oxw(2);return t.KtG(a.onTaxSelectionChange())}),t.ALo(42,"translate"),t.YNc(43,Ir,2,4,"mat-option",13),t.qZA(),t.YNc(44,br,2,1,"div",4),t.qZA(),t.TgZ(45,"td"),t._uU(46),t.ALo(47,"customCurrency"),t.ALo(48,"quantitiesunitprice"),t.YNc(49,yr,5,18,"div",56),t.qZA()()}if(2&e){const r=n.$implicit,o=n.index,a=t.oxw(2);t.Q6J("formGroupName",o),t.xp6(2),t.Q6J("ngIf",1!==a.salesOrderItemsArray.length),t.xp6(2),t.s9C("placeholder",t.lcZ(5,27,"SELECT_PRODUCT")),t.Q6J("dir",a.langDir),t.xp6(3),t.Q6J("ngForOf",a.filterProductsMap[o]),t.xp6(1),t.Q6J("ngIf",0==a.filterProductsMap[o].length),t.xp6(1),t.Q6J("ngIf",r.get("productId").touched&&r.get("productId").errors),t.xp6(2),t.Q6J("dir",a.langDir),t.xp6(1),t.Q6J("ngForOf",a.warehouseMap[o]),t.xp6(2),t.Q6J("dir",a.langDir),t.xp6(1),t.Q6J("ngForOf",a.unitsMap[o]),t.xp6(2),t.s9C("placeholder",t.lcZ(18,29,"UNIT_PER_PRICE")),t.xp6(2),t.Q6J("ngIf",r.get("unitPrice").touched&&r.get("unitPrice").errors),t.xp6(2),t.s9C("placeholder",t.lcZ(22,31,"QUANTITY")),t.xp6(2),t.Q6J("ngIf",r.get("quantity").touched&&r.get("quantity").errors),t.xp6(2),t.s9C("placeholder",t.lcZ(26,33,"RETURN_QUANTITY")),t.xp6(2),t.Q6J("ngIf",r.get("quantity").touched&&r.get("returnquantity").errors),t.xp6(2),t.hij(" ",t.lcZ(30,35,t.xi3(31,37,r.get("returnquantity").value,r.get("unitPrice").value))," "),t.xp6(4),t.s9C("placeholder",t.lcZ(34,40,"DISCOUNT")),t.xp6(3),t.hij(" ",t.lcZ(37,42,t.Dn7(38,44,r.get("returnquantity").value,r.get("unitPrice").value,r.get("discountPercentage").value))," "),t.xp6(3),t.Q6J("ngIf",0!=r.get("discountPercentage").value),t.xp6(2),t.s9C("placeholder",t.lcZ(42,48,"TAX")),t.Q6J("dir",a.langDir),t.xp6(2),t.Q6J("ngForOf",a.taxsMap[o]),t.xp6(1),t.Q6J("ngIf",r.get("taxValue").touched&&r.get("taxValue").errors),t.xp6(2),t.hij(" ",t.lcZ(47,50,t.G7q(48,52,t.qbA(58,et,r.get("returnquantity").value,r.get("unitPrice").value,r.get("discountPercentage").value,r.get("taxValue").value,a.taxsMap[o])))," "),t.xp6(3),t.Q6J("ngIf",r.get("taxValue").value)}}function qr(e,n){1&e&&(t.TgZ(0,"button",71),t._UZ(1,"i",72),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"RETURN"),""))}function Qr(e,n){if(1&e){const r=t.EpF();t.ynx(0),t.TgZ(1,"form",21),t.NdJ("ngSubmit",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.onSalesOrderSubmit())}),t.TgZ(2,"div",7)(3,"div",22)(4,"div",9)(5,"label",23),t._uU(6),t.ALo(7,"translate"),t.TgZ(8,"span"),t._uU(9,"*"),t.qZA()(),t._UZ(10,"input",24),t.YNc(11,ar,2,1,"div",4),t.qZA()(),t.TgZ(12,"div",25)(13,"div",9)(14,"label",26),t._uU(15),t.ALo(16,"translate"),t.qZA(),t._UZ(17,"input",27),t.ALo(18,"translate"),t.YNc(19,sr,2,1,"div",4),t._UZ(20,"owl-date-time",28,29),t.qZA()(),t.TgZ(22,"div",25)(23,"div",9)(24,"label",30),t._uU(25),t.ALo(26,"translate"),t.qZA(),t._UZ(27,"input",31),t.ALo(28,"translate"),t.YNc(29,cr,2,1,"div",4),t._UZ(30,"owl-date-time",28,32),t.qZA()()(),t.TgZ(32,"div",7)(33,"div",8)(34,"div",9)(35,"label",23),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.TgZ(38,"div",10)(39,"mat-select",11),t.ALo(40,"translate"),t._UZ(41,"mat-divider"),t.YNc(42,ur,2,3,"mat-option",13),t.YNc(43,dr,3,3,"mat-option",15),t.qZA()(),t.YNc(44,_r,2,1,"div",4),t.qZA()()(),t.TgZ(45,"div",7)(46,"div",33)(47,"div",9)(48,"label"),t._uU(49),t.ALo(50,"translate"),t.qZA(),t.TgZ(51,"div",10)(52,"textarea",34),t._uU(53,"          "),t.qZA()()()()(),t.TgZ(54,"div",7)(55,"div",35)(56,"div",7)(57,"div",36)(58,"div",37)(59,"table",38)(60,"tr")(61,"th",39),t._uU(62," \xa0 "),t.qZA(),t.TgZ(63,"th",40),t._uU(64),t.ALo(65,"translate"),t.qZA(),t.TgZ(66,"th",40),t._uU(67),t.ALo(68,"translate"),t.qZA(),t.TgZ(69,"th",41),t._uU(70),t.ALo(71,"translate"),t.qZA(),t.TgZ(72,"th",42),t._uU(73),t.ALo(74,"translate"),t.qZA(),t.TgZ(75,"th",43),t._uU(76),t.ALo(77,"translate"),t.qZA(),t.TgZ(78,"th",43),t._uU(79),t.ALo(80,"translate"),t.qZA(),t.TgZ(81,"th",44),t._uU(82),t.ALo(83,"translate"),t.qZA(),t.TgZ(84,"th",44),t._uU(85),t.ALo(86,"translate"),t.qZA(),t.TgZ(87,"th",44),t._uU(88),t.ALo(89,"translate"),t.qZA(),t.TgZ(90,"th",45),t._uU(91),t.ALo(92,"translate"),t.qZA(),t.TgZ(93,"th",41),t._uU(94),t.ALo(95,"translate"),t.qZA()(),t.YNc(96,Er,50,64,"tr",46),t.qZA()()()()()(),t.TgZ(97,"div",47)(98,"div",48),t._uU(99),t.ALo(100,"translate"),t.qZA(),t.TgZ(101,"div",49),t._uU(102),t.ALo(103,"customCurrency"),t.qZA()(),t.TgZ(104,"div",7)(105,"div",48),t._uU(106),t.ALo(107,"translate"),t.qZA(),t.TgZ(108,"div",50),t._uU(109),t.ALo(110,"customCurrency"),t.qZA()(),t.TgZ(111,"div",7)(112,"div",48),t._uU(113),t.ALo(114,"translate"),t.qZA(),t.TgZ(115,"div",49),t._uU(116),t.ALo(117,"customCurrency"),t.qZA()(),t.TgZ(118,"div",7)(119,"div",51),t._UZ(120,"mat-divider"),t.qZA()(),t.TgZ(121,"div",7)(122,"div",48),t._uU(123),t.ALo(124,"translate"),t.qZA(),t.TgZ(125,"div",49),t._uU(126),t.ALo(127,"customCurrency"),t.qZA()(),t.TgZ(128,"div",7)(129,"div",52),t.YNc(130,qr,4,3,"button",53),t.TgZ(131,"button",54),t.NdJ("click",function(){t.CHM(r);const a=t.oxw();return t.KtG(a.cancel())}),t._UZ(132,"i",55),t._uU(133),t.ALo(134,"translate"),t.qZA()()()(),t.BQk()}if(2&e){const r=t.MAs(21),o=t.MAs(31),a=t.oxw();t.xp6(1),t.Q6J("formGroup",a.salesOrderForm),t.xp6(5),t.hij("",t.lcZ(7,45,"SO_NUMBER")," "),t.xp6(4),t.Q6J("readonly",a.isEdit),t.xp6(1),t.Q6J("ngIf",a.salesOrderForm.get("orderNumber").touched&&a.salesOrderForm.get("orderNumber").errors),t.xp6(4),t.hij("",t.lcZ(16,47,"ORDER_DATE")," *"),t.xp6(2),t.s9C("placeholder",t.lcZ(18,49,"DELIVERY_DATE")),t.Q6J("owlDateTimeTrigger",r)("owlDateTime",r),t.xp6(2),t.Q6J("ngIf",a.salesOrderForm.get("soCreatedDate").touched&&a.salesOrderForm.get("soCreatedDate").errors),t.xp6(1),t.Q6J("pickerType","calendar"),t.xp6(5),t.hij("",t.lcZ(26,51,"DELIVERY_DATE")," *"),t.xp6(2),t.s9C("placeholder",t.lcZ(28,53,"DELIVERY_DATE")),t.Q6J("owlDateTimeTrigger",o)("owlDateTime",o),t.xp6(2),t.Q6J("ngIf",a.salesOrderForm.get("deliveryDate").touched&&a.salesOrderForm.get("deliveryDate").errors),t.xp6(1),t.Q6J("pickerType","calendar"),t.xp6(6),t.hij("",t.lcZ(37,55,"CUSTOMER_NAME")," *"),t.xp6(3),t.MGl("placeholder"," ",t.lcZ(40,57,"SELECT_CUSTOMER"),""),t.Q6J("dir",a.langDir),t.xp6(3),t.Q6J("ngForOf",a.customers),t.xp6(1),t.Q6J("ngIf",0==a.customers.length),t.xp6(1),t.Q6J("ngIf",a.salesOrderForm.get("customerId").touched&&a.salesOrderForm.get("customerId").errors),t.xp6(5),t.hij("",t.lcZ(50,59,"RETURN_NOTES")," "),t.xp6(15),t.hij(" ",t.lcZ(65,61,"PRODUCT")," "),t.xp6(3),t.hij(" ",t.lcZ(68,63,"WAREHOUSE")," "),t.xp6(3),t.hij(" ",t.lcZ(71,65,"UNIT")," "),t.xp6(3),t.hij(" ",t.lcZ(74,67,"PRICE")," "),t.xp6(3),t.hij(" ",t.lcZ(77,69,"QUANTITY")," "),t.xp6(3),t.hij(" ",t.lcZ(80,71,"RETURN_QUANTITY")," "),t.xp6(3),t.hij(" ",t.lcZ(83,73,"SUBTOTAL_BEFORE_DISCOUNT")," "),t.xp6(3),t.hij(" ",t.lcZ(86,75,"DISCOUNT"),"% "),t.xp6(3),t.hij(" ",t.lcZ(89,77,"SUBTOTAL_AFTER_DISCOUNT")," "),t.xp6(3),t.hij(" ",t.lcZ(92,79,"TAX")," "),t.xp6(3),t.hij(" ",t.lcZ(95,81,"TOTAL")," "),t.xp6(2),t.Q6J("ngForOf",null==a.salesOrderItemsArray?null:a.salesOrderItemsArray.controls),t.xp6(3),t.hij(" ",t.lcZ(100,83,"SUB_TOTAL_BEFORE_DISCOUNT")," "),t.xp6(3),t.hij(" ",t.lcZ(103,85,a.totalBeforeDiscount)," "),t.xp6(4),t.hij(" ",t.lcZ(107,87,"TOTAL_DISCOUNT"),": "),t.xp6(3),t.hij(" ",t.lcZ(110,89,a.totalDiscount)," "),t.xp6(4),t.hij(" ",t.lcZ(114,91,"TOTAL_TAX"),": "),t.xp6(3),t.hij(" ",t.lcZ(117,93,a.totalTax)," "),t.xp6(7),t.hij(" ",t.lcZ(124,95,"GRAND_TOTAL")," : "),t.xp6(3),t.hij(" ",t.lcZ(127,97,a.grandTotal)," "),t.xp6(4),t.Q6J("hasClaim","SO_RETURN_SO"),t.xp6(3),t.hij(" ",t.lcZ(134,99,"CANCEL")," ")}}function Yr(e,n){1&e&&t._UZ(0,"mat-spinner")}function Fr(e,n){if(1&e&&(t.TgZ(0,"div",73),t.YNc(1,Yr,1,0,"mat-spinner",4),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.isLoading)}}let rt=(()=>{class e extends D.H{constructor(r,o,a,s,u,m,x,w,j,Gr,Xr,zr,nt){super(nt),this.fb=r,this.customerService=o,this.toastrService=a,this.salesOrderService=s,this.router=u,this.taxService=m,this.productService=x,this.route=w,this.quantitiesUnitPricePipe=j,this.quantitiesUnitPriceTaxPipe=Gr,this.location=Xr,this.cloneService=zr,this.translationService=nt,this.products=[],this.customersForSearch=[],this.customers=[],this.salesorders=[],this.isLoading=!1,this.isCustomerLoading=!1,this.filterProductsMap={},this.warehouseMap={},this.unitsMap={},this.taxsMap={},this.totalBeforeDiscount=0,this.totalAfterDiscount=0,this.totalDiscount=0,this.grandTotal=0,this.totalTax=0,this.isEdit=!1,this.getLangDir(),this.salesResouce=new R.e,this.salesOrderResource=new R.e,this.customerResource=new He.H,this.productResource=new Ge.f}get salesOrderItemsArray(){return this.salesOrderForm.get("salesOrderItems")}ngOnInit(){this.createSalesOrder(),this.getTaxes()}onFilterValue(r){console.log(r)}getTaxes(){this.taxes$=this.taxService.entities$}createSalesOrderReturnOrder(){this.salesOrderReturnForm=this.fb.group({orderNumber:[""],filerCustomer:[""],customerId:[""],salesOrderId:[""],filerSalesOrder:[""]}),this.getCustomers(),this.customerNameForSearchChangeValue(),this.subscribeCustomerChangeEvent(),this.subscribeSalesOrderFilterChangeEvent(),this.onSalesOrderChange()}subscribeCustomerChangeEvent(){this.salesOrderReturnForm.get("customerId").valueChanges.pipe((0,g.b)(500),(0,f.x)(),(0,T.w)(r=>(this.salesResouce.customerId=r,this.salesResouce.status=h.q.Not_Return,this.salesOrderService.getAllSalesOrder(this.salesResouce)))).subscribe(r=>{r&&r.headers&&(this.salesorders=[...r.body])})}subscribeSalesOrderFilterChangeEvent(){this.salesOrderReturnForm.get("filerSalesOrder").valueChanges.pipe((0,g.b)(500),(0,f.x)(),(0,T.w)(r=>(this.salesResouce.orderNumber=r,this.salesOrderService.getAllSalesOrder(this.salesResouce)))).subscribe(r=>{r&&r.headers&&(this.salesorders=[...r.body])})}onSalesOrderChange(){this.salesOrderReturnForm.get("salesOrderId").valueChanges.subscribe(r=>{r&&this.router.navigate(["/sales-order-return",r])})}createSalesOrder(){this.route.data.pipe().subscribe(r=>{this.salesOrder=r.salesorder,this.salesOrder?(this.isEdit=!0,this.salesOrderForm=this.fb.group({orderNumber:[{value:this.salesOrder.orderNumber,disabled:!0}],filerCustomer:[{value:"",disabled:!0}],deliveryDate:[{value:this.salesOrder.deliveryDate,disabled:!0}],soCreatedDate:[{value:this.salesOrder.soCreatedDate,disabled:!0}],deliveryStatus:[{value:h.q.Return,disabled:!0}],customerId:[{value:this.salesOrder.customerId,disabled:!0}],note:[{value:"",disabled:!1}],salesOrderItems:this.fb.array([])}),this.salesOrder.salesOrderItems.forEach(o=>{this.salesOrderItemsArray.push(this.createSalesOrderItemPatch(this.salesOrderItemsArray.length,o))}),this.customerNameChangeValue(),this.getCustomers(),this.getAllTotal()):(this.createSalesOrderReturnOrder(),this.salesResouce.pageSize=10,this.salesResouce.status=h.q.Not_Return,this.salesOrderService.getAllSalesOrder(this.salesResouce).subscribe(o=>{o&&o.headers&&(this.salesorders=[...o.body])}))})}createSalesOrderItemPatch(r,o){const a=o.salesOrderItemTaxes.map(u=>u.taxId),s=this.fb.group({productId:[{value:o.productId,disabled:!0}],unitPrice:[{value:o.unitPrice,disabled:!0}],quantity:[{value:o.quantity,disabled:!0}],returnquantity:[{value:o.quantity,disabled:!1},[c.kI.required,c.kI.max(o.quantity),c.kI.min(1)]],taxValue:[{value:a,disabled:!0}],unitId:[{value:o.unitId,disabled:!0}],warehouseId:[{value:o.warehouseId,disabled:!0}],discountPercentage:[{value:o.discountPercentage,disabled:!0}]});return this.unitsMap[r]=[...this.route.snapshot.data.units],this.warehouseMap[r]=[...this.route.snapshot.data.warehouses],this.taxsMap[r]=[...this.route.snapshot.data.taxs],this.filterProductsMap[r.toString()]=[o.product],s}customerNameForSearchChangeValue(){this.sub$.sink=this.salesOrderReturnForm.get("filerCustomer").valueChanges.pipe((0,N.b)(r=>this.isCustomerLoading=!0),(0,g.b)(500),(0,f.x)(),(0,T.w)(r=>(this.customerResource.customerName=r,this.customerResource.id=null,this.customerService.getCustomers(this.customerResource)))).subscribe(r=>{this.isCustomerLoading=!1,r&&r.headers&&(this.customersForSearch=[...r.body])},r=>{this.isCustomerLoading=!1})}customerNameChangeValue(){this.sub$.sink=this.salesOrderForm.get("filerCustomer").valueChanges.pipe((0,N.b)(r=>this.isCustomerLoading=!0),(0,g.b)(500),(0,f.x)(),(0,T.w)(r=>(this.customerResource.customerName=r,this.customerResource.id=null,this.customerService.getCustomers(this.customerResource)))).subscribe(r=>{this.isCustomerLoading=!1,r&&r.headers&&(this.customers=[...r.body])},r=>{this.isCustomerLoading=!1})}getAllTotal(){let o=this.salesOrderForm.get("salesOrderItems").getRawValue();this.totalBeforeDiscount=0,this.grandTotal=0,this.totalDiscount=0,this.totalTax=0,o&&o.length>0&&o.forEach(a=>{if(a.unitPrice&&a.returnquantity){const s=this.totalBeforeDiscount+parseFloat(this.quantitiesUnitPricePipe.transform(a.returnquantity,a.unitPrice));this.totalBeforeDiscount=parseFloat(s.toFixed(2));const u=this.grandTotal+parseFloat(this.quantitiesUnitPricePipe.transform(a.returnquantity,a.unitPrice,a.discountPercentage,a.taxValue,this.taxsMap[0]));this.grandTotal=parseFloat(u.toFixed(2));const m=this.totalTax+parseFloat(this.quantitiesUnitPriceTaxPipe.transform(a.returnquantity,a.unitPrice,a.discountPercentage,a.taxValue,this.taxsMap[0]));this.totalTax=parseFloat(m.toFixed(2));const x=this.totalDiscount+parseFloat(this.quantitiesUnitPriceTaxPipe.transform(a.returnquantity,a.unitPrice,a.discountPercentage));this.totalDiscount=parseFloat(x.toFixed(2))}})}onQuantityChange(){this.getAllTotal()}onRemoveSalesOrderItem(r){this.salesOrderItemsArray.removeAt(r),this.salesOrderItemsArray.controls.forEach((o,a)=>{const s=o.get("productId").value;this.salesOrder.salesOrderItems.map(u=>{u.product.id===s&&(this.filterProductsMap[a.toString()]=this.cloneService.deepClone([u.product]))})}),this.getAllTotal()}getProducts(r){0===this.products.length?(this.productResource.name="",this.productService.getProducts(this.productResource).subscribe(o=>{this.products=[...o.body],this.filterProductsMap[r.toString()]=[...o.body]},o=>{})):this.filterProductsMap[r.toString()]=[...this.products]}onProductSelectionChange(r,o){this.salesOrderItemsArray.controls[o].patchValue({filterProductValue:""});const a=this.filterProductsMap[o].find(s=>s.id===r.value);a&&this.salesOrderItemsArray.controls[o].patchValue({unitId:a.unitId,warehouseId:a.warehouseId})}getNewSalesOrderNumber(){this.salesOrderService.getNewSalesOrderNumber().subscribe(r=>{this.salesOrder||this.salesOrderForm.patchValue({orderNumber:r.orderNumber})})}getCustomers(){this.salesOrder?this.customerResource.id=this.salesOrder.customerId:(this.customerResource.customerName="",this.customerResource.id=null),this.customerService.getCustomers(this.customerResource).subscribe(r=>{r&&r.headers&&(this.customers=[...r.body],this.customersForSearch=[...r.body])})}onSalesOrderSubmit(){if(this.salesOrderForm.valid){if(this.salesOrder&&this.salesOrder.salesOrderStatus===h.q.Return)return void this.toastrService.error("Sales Order can't edit becuase it's already approved.");const r=this.buildSalesOrder();r.id&&this.salesOrderService.updateSalesOrderReturn(r).subscribe(o=>{this.toastrService.success("Sales order return added."),this.router.navigate(["/sales-order/list"])})}else this.salesOrderForm.markAllAsTouched()}buildSalesOrder(){const r={id:this.salesOrder?this.salesOrder.id:"",orderNumber:this.salesOrderForm.get("orderNumber").value,deliveryDate:this.salesOrderForm.get("deliveryDate").value,deliveryStatus:ke.I.UnDelivery,isSalesOrderRequest:!1,soCreatedDate:this.salesOrderForm.get("soCreatedDate").value,salesOrderStatus:h.q.Return,customerId:this.salesOrderForm.get("customerId").value,totalAmount:this.grandTotal,totalDiscount:this.totalDiscount,totalTax:this.totalTax,note:this.salesOrderForm.get("note").value,salesOrderItems:[]},a=this.salesOrderForm.get("salesOrderItems").getRawValue();return a&&a.length>0&&a.forEach(s=>{r.salesOrderItems.push({discount:parseFloat(this.quantitiesUnitPriceTaxPipe.transform(s.returnquantity,s.unitPrice,s.discountPercentage)),discountPercentage:s.discountPercentage,productId:s.productId,unitId:s.unitId,warehouseId:s.warehouseId,quantity:s.returnquantity,taxValue:parseFloat(this.quantitiesUnitPriceTaxPipe.transform(s.returnquantity,s.unitPrice,s.discountPercentage,s.taxValue,this.taxsMap[0])),unitPrice:parseFloat(s.unitPrice),salesOrderItemTaxes:s.taxValue?[...s.taxValue.map(u=>({taxId:u}))]:[]})}),r}cancel(){this.location.back()}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(c.QS),t.Y36(H.v),t.Y36(k._W),t.Y36(L.V),t.Y36(_.F0),t.Y36(Xe.D),t.Y36(ze.M),t.Y36(_.gz),t.Y36(J.q),t.Y36(F.S),t.Y36(d.Ye),t.Y36(X.$),t.Y36(I.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sale-order-return"]],features:[t._Bn([],[J.q,F.S]),t.qOj],decls:10,vars:6,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],[4,"ngIf"],["class","loading-shade",4,"ngIf"],["autocomplete","off",3,"formGroup"],[1,"row"],[1,"col-sm-6","col-md-4"],[1,"form-group"],[1,"input-group"],["formControlName","customerId",1,"form-control",3,"dir","placeholder"],["formControlName","filerCustomer","focused","'true'","type","text","autocomplete","off",1,"form-control","w-100",3,"placeholder"],[3,"dir","value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value",4,"ngIf"],["formControlName","salesOrderId",1,"form-control",3,"dir","placeholder"],["formControlName","filerSalesOrder","focused","'true'","type","text","autocomplete","off",1,"form-control","w-100",3,"placeholder"],[3,"dir","value"],["value",""],[3,"value"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"col-sm-4"],[1,"text-danger"],["formControlName","orderNumber","type","text",1,"form-control","w-100",3,"readonly"],[1,"col-md-4"],["for","soCreatedDate",1,"text-danger"],["id","soCreatedDate","formControlName","soCreatedDate",1,"form-control",3,"owlDateTimeTrigger","owlDateTime","placeholder"],[3,"pickerType"],["soCreatedDate",""],["for","deliveryDate",1,"text-danger"],["id","deliveryDate","formControlName","deliveryDate",1,"form-control",3,"owlDateTimeTrigger","owlDateTime","placeholder"],["deliveryDate",""],[1,"col-sm-12"],["formControlName","note",1,"form-control","w-100"],["formArrayName","salesOrderItems",1,"col-sm-12"],[1,"col"],[1,"table-responsive"],[1,"table","table-bordered","table-hover","table-sm"],[1,"table-column-50"],[1,"table-column-200"],[1,"table-column-150"],[1,"table-column-130"],[1,"table-column-120"],[1,"table-column-100"],[1,"table-column-300"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"col-10","text-right","font-weight-bold"],[1,"col-2","text-left","font-weight-bold"],[1,"col-2","text-left","text-danger","font-weight-bold"],[1,"col-12"],[1,"col-md-12","mb-1"],["type","submit","class","btn btn-success btn-sm m-right-10",4,"hasClaim"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-times-circle"],["class","text-danger",4,"ngIf"],[3,"formGroupName"],["mat-icon-button","","aria-label","Action",3,"click",4,"ngIf"],["formControlName","productId",1,"form-control",3,"dir","placeholder","selectionChange"],[3,"dir","value",4,"ngIf"],["formControlName","warehouseId",1,"form-control-plaintext",3,"dir"],[3,"value",4,"ngFor","ngForOf"],["formControlName","unitId",1,"form-control-plaintext",3,"dir"],["type","number","formControlName","unitPrice",1,"form-control",3,"placeholder"],["type","number","formControlName","quantity",1,"form-control",3,"placeholder"],["type","number","formControlName","returnquantity",1,"form-control",3,"placeholder","change"],["formControlName","discountPercentage",1,"form-control",3,"placeholder","change"],["formControlName","taxValue","multiple","",1,"form-control",3,"dir","placeholder","selectionChange"],["mat-icon-button","","aria-label","Action",3,"click"],[1,"btn-danger"],["type","submit",1,"btn","btn-success","btn-sm","m-right-10"],[1,"fas","fa-save"],[1,"loading-shade"]],template:function(r,o){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()(),t.YNc(7,nr,30,26,"ng-container",4),t.YNc(8,Qr,135,101,"ng-container",4),t.YNc(9,Fr,2,1,"div",5)),2&r&&(t.xp6(5),t.Oqu(t.lcZ(6,4,"RETURN_SALES_ORDER")),t.xp6(2),t.Q6J("ngIf",!o.salesOrder),t.xp6(1),t.Q6J("ngIf",o.salesOrder),t.xp6(1),t.Q6J("ngIf",o.isLoading))},dependencies:[d.sg,d.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,z.d,U.Lv,W.gD,b.ey,y.Hw,E.lW,A.Ou,O.sZ,O.BO,O.hV,tt.d,Q.R,Y.X$,J.q,F.S],styles:[".hr[_ngcontent-%COMP%]{border-bottom:1px solid #2095F3}"]}),e})();const Jr=[{path:"list",component:Ve,data:{claimType:"SO_RETURN_SO"},canActivate:[S.a]},{path:"add",component:rt,data:{claimType:"SO_RETURN_SO"},canActivate:[S.a],resolve:{units:V.l,taxs:$.B,warehouses:B.m,products:M.S}},{path:":id",component:rt,data:{claimType:"SO_RETURN_SO"},canActivate:[S.a],resolve:{units:V.l,taxs:$.B,warehouses:B.m,salesorder:ot.D,products:M.S}}];let wr=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[_.Bz.forChild(Jr),_.Bz]}),e})();var jr=i(7108),Pr=i(6856),Mr=i(7531),Br=i(7322),$r=i(9814),Vr=i(9224),Hr=i(7446);let kr=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,wr,c.u5,c.UX,jr.m,Pr.FA,b.XK,Mr.c,Br.lN,$r.Fk,W.LD,Vr.QW,C.Tx,y.Ps,E.ot,q.Bb,A.Cq,O.Ll,O.x,Hr.p9,tt.t,G.Is,l.p0,v.TU,Z.JX]}),e})()}}]);