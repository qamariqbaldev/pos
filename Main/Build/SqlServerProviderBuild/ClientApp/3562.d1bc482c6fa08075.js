"use strict";(self.webpackChunkposadminportal=self.webpackChunkposadminportal||[]).push([[3562],{3562:(Da,j,s)=>{s.r(j),s.d(j,{SalesOrderModule:()=>Ua});var m=s(9808),c=s(3075),et=s(7108),rt=s(6856),D=s(508),at=s(7531),nt=s(7322),ot=s(9814),M=s(4107),st=s(9224),d=s(2075),E=s(6087),x=s(4847),T=s(2181),q=s(5245),b=s(7423),y=s(1079),f=s(773),O=s(1122),it=s(7446),B=s(4834),p=s(2554),h=s(1777),lt=s(708),ct=s(8929),dt=s(6787),ut=s(567),Z=s(13),A=s(5778),C=s(7545),k=s(2868),S=s(1490),mt=s(3085),_t=s(931),pt=s(1739),t=s(5e3),v=s(838),V=s(1781),ht=s(5485),R=s(2290),I=s(6107),gt=s(2349),$=s(8265),Y=s(9785),Q=s(226),H=s(6717),U=s(8708),N=s(1062);function ft(e,n){1&e&&(t.TgZ(0,"div",21),t._UZ(1,"mat-spinner"),t.qZA())}function Ot(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"PRODUCT_NAME")))}function Zt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",r.productName," ")}}function At(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"SOURCE")))}function xt(e,n){1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SALES_ORDER_RETURN")," "))}function Tt(e,n){1&e&&(t.ynx(0),t._uU(1),t.ALo(2,"translate"),t.BQk()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SALES_ORDER")," "))}function Ct(e,n){if(1&e&&(t.TgZ(0,"td",23),t.YNc(1,xt,3,3,"ng-container",24),t.YNc(2,Tt,3,3,"ng-container",24),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngIf",1===r.status),t.xp6(1),t.Q6J("ngIf",1!==r.status)}}function St(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT")," "))}function vt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",r.unitName," ")}}function It(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT_PER_PRICE")," "))}function Ut(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.unitPrice)," ")}}function Nt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY")," "))}function Lt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",1===r.status?-1*r.quantity:r.quantity," ")}}function Dt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_DISCOUNT")," "))}function Et(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,r.discount),"(",r.discountPercentage,"%) ")}}function qt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TAX")," "))}function bt(e,n){1&e&&(t.TgZ(0,"span"),t._uU(1," ,"),t.qZA())}function yt(e,n){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.YNc(2,bt,2,0,"span",24),t.qZA()),2&e){const r=n.$implicit,a=n.last;t.xp6(1),t.AsE(" ",r.taxName,"(",r.taxPercentage,"%) "),t.xp6(1),t.Q6J("ngIf",!a)}}function Rt(e,n){if(1&e&&(t.TgZ(0,"td",23),t.YNc(1,yt,3,3,"span",25),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngForOf",r.salesOrderItemTaxes)}}function Yt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_TAX")," "))}function Qt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.taxValue)," ")}}function Pt(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL")," "))}function wt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.unitPrice*r.quantity-r.discount+r.taxValue)," ")}}function Ft(e,n){1&e&&(t.TgZ(0,"th",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"WAREHOUSE"),""))}function Jt(e,n){if(1&e&&(t.TgZ(0,"td",23),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",r.warehouseName," ")}}function jt(e,n){1&e&&t._UZ(0,"tr",26)}function Mt(e,n){1&e&&t._UZ(0,"tr",27),2&e&&t.ekj("bg-warning1",1===n.$implicit.status)}let Bt=(()=>{class e extends S.H{constructor(r,a){super(a),this.salesOrderService=r,this.translationService=a,this.salesOrderItems=[],this.isLoading=!1,this.displayedColumns=["productName","source","unitName","unitPrice","quantity","totalDiscount","taxes","totalTax","totalAmount","warehouse"],this.getLangDir()}ngOnInit(){}ngOnChanges(r){r.salesOrder&&this.getSalesOrderItems()}getSalesOrderItems(){this.isLoading=!0,this.salesOrderService.getSalesOrderItems(this.salesOrder.id).subscribe(r=>{this.isLoading=!1,this.salesOrderItems=r},()=>this.isLoading=!1)}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(v.V),t.Y36(I.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sales-order-items"]],inputs:{salesOrder:"salesOrder"},features:[t.qOj,t.TTD],decls:42,vars:9,consts:[[1,"page-header-main"],[1,"row","align-items-center"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","loading-shade",4,"ngIf"],[1,"table-responsive"],["mat-table","",1,"table","table-bordered","table-hover",3,"dir","dataSource"],["matColumnDef","productName"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","source"],["matColumnDef","unitName"],["matColumnDef","unitPrice"],["matColumnDef","quantity"],["matColumnDef","totalDiscount"],["matColumnDef","taxes"],["matColumnDef","totalTax"],["matColumnDef","totalAmount"],["matColumnDef","warehouse"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"bg-warning1",4,"matRowDef","matRowDefColumns"],[1,"loading-shade"],["mat-header-cell",""],["mat-cell",""],[4,"ngIf"],[4,"ngFor","ngForOf"],["mat-header-row",""],["mat-row",""]],template:function(r,a){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()(),t.YNc(7,ft,2,0,"div",4),t.TgZ(8,"div",5)(9,"table",6),t.ynx(10,7),t.YNc(11,Ot,3,3,"th",8),t.YNc(12,Zt,2,1,"td",9),t.BQk(),t.ynx(13,10),t.YNc(14,At,3,3,"th",8),t.YNc(15,Ct,3,2,"td",9),t.BQk(),t.ynx(16,11),t.YNc(17,St,3,3,"th",8),t.YNc(18,vt,2,1,"td",9),t.BQk(),t.ynx(19,12),t.YNc(20,It,3,3,"th",8),t.YNc(21,Ut,3,3,"td",9),t.BQk(),t.ynx(22,13),t.YNc(23,Nt,3,3,"th",8),t.YNc(24,Lt,2,1,"td",9),t.BQk(),t.ynx(25,14),t.YNc(26,Dt,3,3,"th",8),t.YNc(27,Et,3,4,"td",9),t.BQk(),t.ynx(28,15),t.YNc(29,qt,3,3,"th",8),t.YNc(30,Rt,2,1,"td",9),t.BQk(),t.ynx(31,16),t.YNc(32,Yt,3,3,"th",8),t.YNc(33,Qt,3,3,"td",9),t.BQk(),t.ynx(34,17),t.YNc(35,Pt,3,3,"th",8),t.YNc(36,wt,3,3,"td",9),t.BQk(),t.ynx(37,18),t.YNc(38,Ft,3,3,"th",8),t.YNc(39,Jt,2,1,"td",9),t.BQk(),t.YNc(40,jt,1,0,"tr",19),t.YNc(41,Mt,1,2,"tr",20),t.qZA()()),2&r&&(t.xp6(5),t.Oqu(t.lcZ(6,7,"SALES_ORDER_ITEMS")),t.xp6(2),t.Q6J("ngIf",a.isLoading),t.xp6(2),t.Q6J("dir",a.langDir)("dataSource",a.salesOrderItems),t.xp6(31),t.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns))},dependencies:[m.sg,m.O5,Q.Lv,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.ge,d.ev,d.XQ,d.Gk,f.Ou,U.R,N.X$]}),e})();var G=s(8017),K=s(2989);const kt=function(){return["/sales-order/add"]};function Vt(e,n){1&e&&(t.TgZ(0,"button",52),t._UZ(1,"i",53),t._uU(2),t.ALo(3,"translate"),t.qZA()),2&e&&(t.Q6J("routerLink",t.DdM(4,kt)),t.xp6(2),t.hij(" ",t.lcZ(3,2,"ADD_SALES_ORDER")," "))}function $t(e,n){1&e&&(t.TgZ(0,"div",54),t._UZ(1,"mat-spinner"),t.qZA())}function Ht(e,n){1&e&&t._UZ(0,"th",55)}function Gt(e,n){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"chevron_right"),t.qZA())}function Kt(e,n){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1,"expand_more"),t.qZA())}function Xt(e,n){if(1&e&&(t.TgZ(0,"button",63)(1,"mat-icon"),t._uU(2,"more_vert"),t.qZA()()),2&e){t.oxw();const r=t.MAs(6);t.Q6J("matMenuTriggerFor",r)}}const zt=function(e){return["/sales-order/",e]};function Wt(e,n){if(1&e&&(t.TgZ(0,"button",64)(1,"mat-icon"),t._uU(2,"edit"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&e){const r=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(4,zt,r.id)),t.xp6(4),t.Oqu(t.lcZ(5,2,"EDIT"))}}function te(e,n){1&e&&(t.ynx(0),t.YNc(1,Wt,6,6,"button",61),t.BQk()),2&e&&(t.xp6(1),t.Q6J("hasClaim","SO_UPDATE_SO"))}const X=function(e){return["/sales-order/detail",e]};function ee(e,n){if(1&e&&(t.TgZ(0,"button",64)(1,"mat-icon"),t._uU(2,"info"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()),2&e){const r=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(4,X,r.id)),t.xp6(4),t.Oqu(t.lcZ(5,2,"DETAIL"))}}function re(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",65),t.NdJ("click",function(){t.CHM(r);const o=t.oxw(2).$implicit,i=t.oxw();return t.KtG(i.deleteSalesOrder(o))}),t.TgZ(1,"mat-icon"),t._uU(2,"delete"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"DELETE")))}function ae(e,n){1&e&&(t.ynx(0),t.YNc(1,re,6,3,"button",62),t.BQk()),2&e&&(t.xp6(1),t.Q6J("hasClaim","SO_DELETE_SO"))}function ne(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",65),t.NdJ("click",function(){t.CHM(r);const o=t.oxw(2).$implicit,i=t.oxw();return t.KtG(i.onSaleOrderReturn(o))}),t.TgZ(1,"mat-icon"),t._uU(2,"assignment_return"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"RETURN_SALES_ORDER")))}function oe(e,n){1&e&&(t.ynx(0),t.YNc(1,ne,6,3,"button",62),t.BQk()),2&e&&(t.xp6(1),t.Q6J("hasClaim","SO_RETURN_SO"))}function se(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",65),t.NdJ("click",function(){t.CHM(r);const o=t.oxw(2).$implicit,i=t.oxw();return t.KtG(i.addPayment(o))}),t.TgZ(1,"mat-icon"),t._uU(2,"payment"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"ADD_PAYMENT")))}function ie(e,n){1&e&&(t.TgZ(0,"ng-contaner"),t.YNc(1,se,6,3,"button",62),t.qZA()),2&e&&(t.xp6(1),t.Q6J("hasClaim","SO_ADD_SO_PAYMENT"))}function le(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",65),t.NdJ("click",function(){t.CHM(r);const o=t.oxw().$implicit,i=t.oxw();return t.KtG(i.viewPayment(o))}),t.TgZ(1,"mat-icon"),t._uU(2,"view_carousel"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"VIEW_PAYMENT")))}function ce(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",65),t.NdJ("click",function(){t.CHM(r);const o=t.oxw().$implicit,i=t.oxw();return t.KtG(i.generateInvoice(o))}),t.TgZ(1,"mat-icon"),t._uU(2,"receipt"),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.ALo(5,"translate"),t.qZA()()}2&e&&(t.xp6(4),t.Oqu(t.lcZ(5,1,"GENERATE_INVOICE")))}const de=function(){return["SO_UPDATE_SO","SO_VIEW_SO_DETAIL","SO_DELETE_SO","SO_RETURN_SO","SO_ADD_SO_PAYMENT","SO_VIEW_SO_PAYMENTS","SO_GENERATE_INVOICE"]};function ue(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"td",56)(1,"button",57),t.NdJ("click",function(){const i=t.CHM(r).$implicit,l=t.oxw();return t.KtG(l.toggleRow(i))}),t.YNc(2,Gt,2,0,"mat-icon",51),t.YNc(3,Kt,2,0,"mat-icon",51),t.qZA(),t.YNc(4,Xt,3,1,"button",58),t.TgZ(5,"mat-menu",59,60),t.YNc(7,te,2,1,"ng-container",51),t.YNc(8,ee,6,6,"button",61),t.YNc(9,ae,2,1,"ng-container",51),t.YNc(10,oe,2,1,"ng-container",51),t.YNc(11,ie,2,1,"ng-contaner",51),t.YNc(12,le,6,3,"button",62),t.YNc(13,ce,6,3,"button",62),t.qZA()()}if(2&e){const r=n.$implicit,a=t.oxw();t.xp6(2),t.Q6J("ngIf",r!=a.expandedElement),t.xp6(1),t.Q6J("ngIf",r==a.expandedElement),t.xp6(1),t.Q6J("hasClaim",t.DdM(11,de)),t.xp6(1),t.Q6J("dir",a.langDir),t.xp6(2),t.Q6J("ngIf",0==r.status),t.xp6(1),t.Q6J("hasClaim","SO_VIEW_SO_DETAIL"),t.xp6(1),t.Q6J("ngIf",0==r.status),t.xp6(1),t.Q6J("ngIf",0==r.status),t.xp6(1),t.Q6J("ngIf",0!=r.paymentStatus),t.xp6(1),t.Q6J("hasClaim","SO_VIEW_SO_PAYMENTS"),t.xp6(1),t.Q6J("hasClaim","SO_GENERATE_INVOICE")}}function me(e,n){1&e&&(t.TgZ(0,"th",66),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CREATED_DATE")," "))}function _e(e,n){if(1&e&&(t.TgZ(0,"td",67),t._uU(1),t.ALo(2,"utcToLocalTime"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.soCreatedDate,"shortDate")," ")}}function pe(e,n){1&e&&(t.TgZ(0,"th",68),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"ORDER_NUMBER")," "))}function he(e,n){if(1&e&&(t.TgZ(0,"td",56)(1,"a",69),t._uU(2),t.qZA()()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,X,r.id)),t.xp6(1),t.hij("",r.orderNumber," ")}}function ge(e,n){1&e&&(t.TgZ(0,"th",68),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DELIVERY_DATE")," "))}function fe(e,n){if(1&e&&(t.TgZ(0,"td",67),t._uU(1),t.ALo(2,"utcToLocalTime"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,r.deliveryDate,"shortDate")," ")}}function Oe(e,n){1&e&&(t.TgZ(0,"th",70),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij("",t.lcZ(2,1,"CUSTOMER_NAME")," "))}const Ze=function(e){return["/customer",e]};function Ae(e,n){if(1&e&&(t.TgZ(0,"td",71)(1,"a",69),t._uU(2),t.qZA()()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("routerLink",t.VKq(2,Ze,r.customerId)),t.xp6(1),t.hij(" ",r.customerName," ")}}function xe(e,n){1&e&&(t.TgZ(0,"th",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_DISCOUNT")," "))}function Te(e,n){if(1&e&&(t.TgZ(0,"td",73),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalDiscount)," ")}}function Ce(e,n){1&e&&(t.TgZ(0,"th",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_TAX")," "))}function Se(e,n){if(1&e&&(t.TgZ(0,"td",73),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalTax)," ")}}function ve(e,n){1&e&&(t.TgZ(0,"th",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_AMOUNT")," "))}function Ie(e,n){if(1&e&&(t.TgZ(0,"td",73),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalAmount)," ")}}function Ue(e,n){1&e&&(t.TgZ(0,"th",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TOTAL_PAID_AMOUNT")," "))}function Ne(e,n){if(1&e&&(t.TgZ(0,"td",73),t._uU(1),t.ALo(2,"customCurrency"),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,r.totalPaidAmount)," ")}}function Le(e,n){1&e&&(t.TgZ(0,"th",68),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PAYMENT_STATUS")," "))}const De=function(e,n,r){return{"badge-success":e,"badge-danger":n,"badge-warning":r}};function Ee(e,n){if(1&e&&(t.TgZ(0,"td",74)(1,"span",75),t._uU(2),t.ALo(3,"paymentStatus"),t.qZA()()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngClass",t.kEZ(4,De,0==r.paymentStatus,1==r.paymentStatus,2==r.paymentStatus)),t.xp6(1),t.Oqu(t.lcZ(3,2,r.paymentStatus))}}function qe(e,n){1&e&&(t.TgZ(0,"th",72),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"IS_RETURN")," "))}function be(e,n){1&e&&(t.TgZ(0,"ng-contaner"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"YES")," "))}function ye(e,n){1&e&&(t.TgZ(0,"ng-contaner"),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NO")," "))}function Re(e,n){if(1&e&&(t.TgZ(0,"td",73),t.YNc(1,be,3,3,"ng-contaner",51),t.YNc(2,ye,3,3,"ng-contaner",51),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngIf",1==r.status),t.xp6(1),t.Q6J("ngIf",1!=r.status)}}function Ye(e,n){1&e&&t._UZ(0,"th",76)}function Qe(e,n){1&e&&t._UZ(0,"th",76)}function Pe(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"th",76)(1,"input",77),t.NdJ("ngModelChange",function(o){t.CHM(r);const i=t.oxw();return t.KtG(i.OrderNumberFilter=o)}),t.ALo(2,"translate"),t.qZA()()}if(2&e){const r=t.oxw();t.xp6(1),t.s9C("placeholder",t.lcZ(2,2,"ORDER_NO")),t.Q6J("ngModel",r.OrderNumberFilter)}}function we(e,n){1&e&&t._UZ(0,"th",76)}function Fe(e,n){if(1&e&&(t.TgZ(0,"mat-option",83),t._uU(1),t.qZA()),2&e){const r=n.$implicit,a=t.oxw(2);t.Q6J("dir",a.langDir)("value",r.customerName),t.xp6(1),t.hij(" ",r.customerName," ")}}function Je(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"th",76),t._UZ(1,"input",78),t.ALo(2,"translate"),t.TgZ(3,"mat-autocomplete",79,80),t.NdJ("optionSelected",function(o){t.CHM(r);const i=t.oxw();return t.KtG(i.CustomerFilter=o.option.value)}),t.TgZ(5,"mat-option",81),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.YNc(8,Fe,2,3,"mat-option",82),t.ALo(9,"async"),t.qZA()()}if(2&e){const r=t.MAs(4),a=t.oxw();t.xp6(1),t.s9C("placeholder",t.lcZ(2,7,"CUSTOMER")),t.Q6J("formControl",a.customerNameControl)("matAutocomplete",r),t.xp6(2),t.Q6J("dir",a.langDir)("autoActiveFirstOption",!0),t.xp6(3),t.Oqu(t.lcZ(7,9,"NONE")),t.xp6(2),t.Q6J("ngForOf",t.lcZ(9,11,a.customerList$))}}function je(e,n){1&e&&t._UZ(0,"th",76)}function Me(e,n){1&e&&t._UZ(0,"th",76)}function Be(e,n){1&e&&t._UZ(0,"th",76)}function ke(e,n){1&e&&t._UZ(0,"th",76)}function Ve(e,n){1&e&&t._UZ(0,"th",76)}function $e(e,n){1&e&&t._UZ(0,"th",76)}const He=function(){return[10,20,30]};function Ge(e,n){if(1&e&&(t.TgZ(0,"td",84),t._UZ(1,"mat-paginator",85),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("dir",r.langDir)("length",r.salesOrderResource.totalCount)("pageSize",r.salesOrderResource.pageSize)("pageSizeOptions",t.DdM(4,He))}}function Ke(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"div",86)(2,"div",87),t._UZ(3,"app-sales-order-items",88),t.qZA()(),t.BQk()),2&e){const r=t.oxw().$implicit,a=t.oxw();t.xp6(1),t.Q6J("@detailExpand",r==a.expandedElement?"expanded":"collapsed"),t.xp6(2),t.Q6J("salesOrder",r)}}function Xe(e,n){if(1&e&&(t.TgZ(0,"td",73),t.YNc(1,Ke,4,2,"ng-container",51),t.qZA()),2&e){const r=n.$implicit,a=t.oxw();t.uIk("colspan",a.displayedColumns.length),t.xp6(1),t.Q6J("ngIf",r==a.expandedElement)}}function ze(e,n){1&e&&(t.TgZ(0,"tr")(1,"td",89)(2,"span",90)(3,"b"),t._uU(4),t.ALo(5,"translate"),t.qZA()()()()),2&e&&(t.xp6(4),t.hij(" ",t.lcZ(5,1,"NO_DATA_FOUND"),""))}function We(e,n){1&e&&t._UZ(0,"tr",91)}function tr(e,n){1&e&&t._UZ(0,"tr",92),2&e&&t.ekj("bg-warning1",1===n.$implicit.status)}function er(e,n){1&e&&t._UZ(0,"tr",91)}function rr(e,n){1&e&&t._UZ(0,"tr",93)}function ar(e,n){1&e&&t._UZ(0,"tr",94)}function nr(e,n){if(1&e&&(t.ynx(0),t._UZ(1,"app-sales-order-invoice",88),t.BQk()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("salesOrder",r.salesOrderForInvoice)}}const or=function(){return["expandedDetail"]};let sr=(()=>{class e extends S.H{constructor(r,a,o,i,l,u,_,g,J){super(_),this.salesOrderService=r,this.customerService=a,this.cd=o,this.commonDialogService=i,this.toastrService=l,this.router=u,this.translationService=_,this.dialog=g,this.clonerService=J,this.salesOrders=[],this.displayedColumns=["action","soCreatedDate","orderNumber","deliveryDate","customerName","totalDiscount","totalTax","totalAmount","totalPaidAmount","paymentStatus","status"],this.filterColumns=["action-search","soCreatedDate-search","orderNumber-search","deliverDate-search","customer-search","totalAmount-search","totalDiscount-search","totalTax-search","totalPaidAmount-search","paymentStatus-search","status-search"],this.footerToDisplayed=["footer"],this.isLoadingResults=!0,this.customerNameControl=new c.p4,this.filterObservable$=new ct.xQ,this.getLangDir(),this.salesOrderResource=new lt.e,this.salesOrderResource.pageSize=50,this.salesOrderResource.orderBy="soCreatedDate asc"}get CustomerFilter(){return this._customerFilter}set CustomerFilter(r){this._customerFilter=r,this.filterObservable$.next(`customerName:${r}`)}get OrderNumberFilter(){return this._orderNumberFilter}set OrderNumberFilter(r){this._orderNumberFilter=r,this.filterObservable$.next(`orderNumber:${r}`)}ngOnInit(){this.customerNameControlOnChange(),this.dataSource=new _t.X(this.salesOrderService),this.dataSource.loadData(this.salesOrderResource),this.getResourceParameter(),this.sub$.sink=this.filterObservable$.pipe((0,Z.b)(1e3),(0,A.x)()).subscribe(r=>{this.salesOrderResource.skip=0,this.paginator.pageIndex=0;const a=r.split(":");"customerName"===a[0]?this.salesOrderResource.customerName=a[1]:"orderNumber"===a[0]&&(this.salesOrderResource.orderNumber=a[1]),this.dataSource.loadData(this.salesOrderResource)})}customerNameControlOnChange(){this.customerList$=this.customerNameControl.valueChanges.pipe((0,Z.b)(1e3),(0,A.x)(),(0,C.w)(r=>this.customerService.getCustomersForDropDown("CustomerName",r)))}ngAfterViewInit(){this.sort.sortChange.subscribe(()=>this.paginator.pageIndex=0),this.sub$.sink=(0,dt.T)(this.sort.sortChange,this.paginator.page).pipe((0,k.b)(r=>{this.salesOrderResource.skip=this.paginator.pageIndex*this.paginator.pageSize,this.salesOrderResource.pageSize=this.paginator.pageSize,this.salesOrderResource.orderBy=this.sort.active+" "+this.sort.direction,this.dataSource.loadData(this.salesOrderResource)})).subscribe()}getResourceParameter(){this.sub$.sink=this.dataSource.responseHeaderSubject$.subscribe(r=>{r&&(this.salesOrderResource.pageSize=r.pageSize,this.salesOrderResource.skip=r.skip,this.salesOrderResource.totalCount=r.totalCount)})}toggleRow(r){this.expandedElement=this.expandedElement===r?null:r,this.cd.detectChanges()}deleteSalesOrder(r){this.commonDialogService.deleteConformationDialog(this.translationService.getValue("ARE_YOU_SURE_YOU_WANT_TO_DELETE")).subscribe(a=>{a&&this.salesOrderService.deleteSalesOrder(r.id).subscribe(()=>{this.toastrService.success(this.translationService.getValue("SALES_ORDER_DELETED_SUCCESSFULLY")),this.dataSource.loadData(this.salesOrderResource)})})}addPayment(r){this.dialog.open(mt.J,{width:"100vh",direction:this.langDir,data:Object.assign({},r)}).afterClosed().subscribe(o=>{o&&this.dataSource.loadData(this.salesOrderResource)})}viewPayment(r){this.dialog.open(pt.G,{data:Object.assign({},r),direction:this.langDir}).afterClosed().subscribe(o=>{o&&this.dataSource.loadData(this.salesOrderResource)})}onSaleOrderReturn(r){this.router.navigate(["sales-order-return",r.id])}generateInvoice(r){let a=this.clonerService.deepClone(r);const o=this.customerService.getCustomer(r.customerId),i=this.salesOrderService.getSalesOrderItems(r.id);(0,ut.D)({getCustomerRequest:o,getSalesOrderItems:i}).subscribe(l=>{a.customer=l.getCustomerRequest,a.salesOrderItems=l.getSalesOrderItems,this.salesOrderForInvoice=a})}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(v.V),t.Y36(V.v),t.Y36(t.sBO),t.Y36(ht.V),t.Y36(R._W),t.Y36(p.F0),t.Y36(I.D),t.Y36(gt.uw),t.Y36($.$))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sales-order-list"]],viewQuery:function(r,a){if(1&r&&(t.Gf(E.NW,5),t.Gf(x.YE,5)),2&r){let o;t.iGM(o=t.CRH())&&(a.paginator=o.first),t.iGM(o=t.CRH())&&(a.sort=o.first)}},features:[t.qOj],decls:81,vars:19,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","btn blue-btn btn-sm m-right-10",3,"routerLink",4,"hasClaim"],["class","loading-shade",4,"ngIf"],[1,"row"],[1,"col-sm-12"],[1,"table-responsive"],["mat-table","","multiTemplateDataRows","","matSort","","matSortActive","soCreatedDate",1,"table","table-bordered","table-hover","grid-height",3,"dir","dataSource"],["matColumnDef","action"],["class","table-column-150","mat-header-cell","",4,"matHeaderCellDef"],["class","table-column-150","mat-cell","",4,"matCellDef"],["matColumnDef","soCreatedDate"],["class","table-column-100","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-100","mat-cell","",4,"matCellDef"],["matColumnDef","orderNumber"],["class","table-column-150","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["matColumnDef","deliveryDate"],["matColumnDef","customerName"],["class","table-column-300","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","table-column-300","mat-cell","",4,"matCellDef"],["matColumnDef","totalDiscount"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","totalTax"],["matColumnDef","totalAmount"],["matColumnDef","totalPaidAmount"],["matColumnDef","paymentStatus"],["class","table-column-150","mat-cell","","style","text-align: center;",4,"matCellDef"],["matColumnDef","status"],["matColumnDef","action-search"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","soCreatedDate-search"],["matColumnDef","orderNumber-search"],["matColumnDef","deliverDate-search"],["matColumnDef","customer-search"],["matColumnDef","totalAmount-search"],["matColumnDef","totalDiscount-search"],["matColumnDef","totalTax-search"],["matColumnDef","totalPaidAmount-search"],["matColumnDef","paymentStatus-search"],["matColumnDef","status-search"],["matColumnDef","footer"],["mat-footer-cell","","colspan","12",4,"matFooterCellDef"],["matColumnDef","expandedDetail"],[4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef","matHeaderRowDefSticky"],["mat-row","",3,"bg-warning1",4,"matRowDef","matRowDefColumns"],["mat-footer-row","",4,"matFooterRowDef","matFooterRowDefSticky"],["mat-row","","class","example-detail-row",4,"matRowDef","matRowDefColumns"],[4,"ngIf"],[1,"btn","blue-btn","btn-sm","m-right-10",3,"routerLink"],[1,"fas","fa-plus"],[1,"loading-shade"],["mat-header-cell","",1,"table-column-150"],["mat-cell","",1,"table-column-150"],["mat-icon-button","",3,"click"],["class","ml-4","mat-icon-button","","aria-label","Action",3,"matMenuTriggerFor",4,"hasClaim"],[3,"dir"],["menu","matMenu"],["mat-menu-item","",3,"routerLink",4,"hasClaim"],["mat-menu-item","",3,"click",4,"hasClaim"],["mat-icon-button","","aria-label","Action",1,"ml-4",3,"matMenuTriggerFor"],["mat-menu-item","",3,"routerLink"],["mat-menu-item","",3,"click"],["mat-header-cell","","mat-sort-header","",1,"table-column-100"],["mat-cell","",1,"table-column-100"],["mat-header-cell","","mat-sort-header","",1,"table-column-150"],[3,"routerLink"],["mat-header-cell","","mat-sort-header","",1,"table-column-300"],["mat-cell","",1,"table-column-300"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-cell","",1,"table-column-150",2,"text-align","center"],[1,"badge-pill",3,"ngClass"],["mat-header-cell",""],["type","text",1,"form-control","w-90",3,"placeholder","ngModel","ngModelChange"],["type","text",1,"form-control","w-90",3,"placeholder","formControl","matAutocomplete"],[3,"dir","autoActiveFirstOption","optionSelected"],["autoCustomer","matAutocomplete"],["value",""],[3,"dir","value",4,"ngFor","ngForOf"],[3,"dir","value"],["mat-footer-cell","","colspan","12"],[3,"dir","length","pageSize","pageSizeOptions"],[1,"example-element-detail"],[1,"inner-table","mat-elevation-z8"],[3,"salesOrder"],["colspan","9"],[1,"p-4","mt-4"],["mat-header-row",""],["mat-row",""],["mat-footer-row",""],["mat-row","",1,"example-detail-row"]],template:function(r,a){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"div",2),t.YNc(8,Vt,4,5,"button",4),t.qZA()()(),t.YNc(9,$t,2,0,"div",5),t.ALo(10,"async"),t.TgZ(11,"div",6)(12,"div",7)(13,"div",8)(14,"table",9),t.ynx(15,10),t.YNc(16,Ht,1,0,"th",11),t.YNc(17,ue,14,12,"td",12),t.BQk(),t.ynx(18,13),t.YNc(19,me,3,3,"th",14),t.YNc(20,_e,3,4,"td",15),t.BQk(),t.ynx(21,16),t.YNc(22,pe,3,3,"th",17),t.YNc(23,he,3,4,"td",12),t.BQk(),t.ynx(24,18),t.YNc(25,ge,3,3,"th",17),t.YNc(26,fe,3,4,"td",15),t.BQk(),t.ynx(27,19),t.YNc(28,Oe,3,3,"th",20),t.YNc(29,Ae,3,4,"td",21),t.BQk(),t.ynx(30,22),t.YNc(31,xe,3,3,"th",23),t.YNc(32,Te,3,3,"td",24),t.BQk(),t.ynx(33,25),t.YNc(34,Ce,3,3,"th",23),t.YNc(35,Se,3,3,"td",24),t.BQk(),t.ynx(36,26),t.YNc(37,ve,3,3,"th",23),t.YNc(38,Ie,3,3,"td",24),t.BQk(),t.ynx(39,27),t.YNc(40,Ue,3,3,"th",23),t.YNc(41,Ne,3,3,"td",24),t.BQk(),t.ynx(42,28),t.YNc(43,Le,3,3,"th",17),t.YNc(44,Ee,4,8,"td",29),t.BQk(),t.ynx(45,30),t.YNc(46,qe,3,3,"th",23),t.YNc(47,Re,3,2,"td",24),t.BQk(),t.ynx(48,31),t.YNc(49,Ye,1,0,"th",32),t.BQk(),t.ynx(50,33),t.YNc(51,Qe,1,0,"th",32),t.BQk(),t.ynx(52,34),t.YNc(53,Pe,3,4,"th",32),t.BQk(),t.ynx(54,35),t.YNc(55,we,1,0,"th",32),t.BQk(),t.ynx(56,36),t.YNc(57,Je,10,13,"th",32),t.BQk(),t.ynx(58,37),t.YNc(59,je,1,0,"th",32),t.BQk(),t.ynx(60,38),t.YNc(61,Me,1,0,"th",32),t.BQk(),t.ynx(62,39),t.YNc(63,Be,1,0,"th",32),t.BQk(),t.ynx(64,40),t.YNc(65,ke,1,0,"th",32),t.BQk(),t.ynx(66,41),t.YNc(67,Ve,1,0,"th",32),t.BQk(),t.ynx(68,42),t.YNc(69,$e,1,0,"th",32),t.BQk(),t.ynx(70,43),t.YNc(71,Ge,2,5,"td",44),t.BQk(),t.ynx(72,45),t.YNc(73,Xe,2,2,"td",24),t.BQk(),t.YNc(74,ze,6,3,"tr",46),t.YNc(75,We,1,0,"tr",47),t.YNc(76,tr,1,2,"tr",48),t.YNc(77,er,1,0,"tr",47),t.YNc(78,rr,1,0,"tr",49),t.YNc(79,ar,1,0,"tr",50),t.qZA()()()(),t.YNc(80,nr,2,1,"ng-container",51)),2&r&&(t.xp6(5),t.Oqu(t.lcZ(6,14,"SALES_ORDER")),t.xp6(3),t.Q6J("hasClaim","SO_ADD_SO"),t.xp6(1),t.Q6J("ngIf",t.lcZ(10,16,a.dataSource.loading$)),t.xp6(5),t.Q6J("dir",a.langDir)("dataSource",a.dataSource),t.xp6(61),t.Q6J("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("matHeaderRowDef",a.filterColumns)("matHeaderRowDefSticky",!0),t.xp6(1),t.Q6J("matFooterRowDef",a.footerToDisplayed)("matFooterRowDefSticky",!0),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(18,or)),t.xp6(1),t.Q6J("ngIf",a.salesOrderForInvoice))},dependencies:[m.mk,m.sg,m.O5,p.rH,p.yS,c.Fj,c.JJ,c.On,c.oH,Y.d,Q.Lv,H.Y,D.ey,d.BZ,d.fO,d.as,d.w1,d.Dz,d.nj,d.mD,d.Ke,d.ge,d.ev,d.yh,d.XQ,d.Gk,d.Q2,d.Ee,E.NW,x.YE,x.nU,T.VK,T.OP,T.p6,q.Hw,b.lW,y.XC,y.ZL,f.Ou,Bt,m.Ov,U.R,G.M,N.X$,K.r],data:{animation:[(0,h.X$)("detailExpand",[(0,h.SB)("collapsed",(0,h.oB)({height:"0px",minHeight:"0"})),(0,h.SB)("expanded",(0,h.oB)({height:"*"})),(0,h.eR)("expanded <=> collapsed",(0,h.jt)("225ms cubic-bezier(0.4, 0.0, 0.2, 1)"))])]}}),e})();var ir=s(3231),lr=s(3007),cr=s(796),z=s(2),P=s(6521),w=s(6695),dr=s(1086),L=s(2746),ur=s(6018),mr=s(5528),_r=s(4603);function pr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"SO_ORDER_NUMBER_IS_REQUIRED")," "))}function hr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,pr,3,3,"div",55),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("orderNumber").errors?null:r.salesOrderForm.get("orderNumber").errors.required)}}function gr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"ORDER_DATE_IS_REQUIRED")," "))}function fr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,gr,3,3,"div",55),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("soCreatedDate").errors?null:r.salesOrderForm.get("soCreatedDate").errors.required)}}function Or(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DELIVERY_DATE_REQUIRED")," "))}function Zr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Or,3,3,"div",55),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("deliveryDate").errors?null:r.salesOrderForm.get("deliveryDate").errors.required)}}function Ar(e,n){if(1&e&&(t.TgZ(0,"mat-option",56),t._uU(1),t.qZA()),2&e){const r=n.$implicit,a=t.oxw();t.Q6J("dir",a.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.customerName," ")}}function xr(e,n){1&e&&(t.TgZ(0,"mat-option",57),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NO_RECORDS")," "))}function Tr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"CUSTOMER_NAME_IS_REQUIRED")," "))}function Cr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Tr,3,3,"div",55),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",null==r.salesOrderForm.get("customerId").errors?null:r.salesOrderForm.get("customerId").errors.required)}}function Sr(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",69),t.NdJ("click",function(){t.CHM(r);const o=t.oxw().index,i=t.oxw();return t.KtG(i.onRemoveSalesOrderItem(o))}),t.TgZ(1,"mat-icon",70),t._uU(2,"delete_forever"),t.qZA()()}}function vr(e,n){if(1&e&&(t.TgZ(0,"mat-option",56),t._uU(1),t.qZA()),2&e){const r=n.$implicit,a=t.oxw(2);t.Q6J("dir",a.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function Ir(e,n){1&e&&(t.TgZ(0,"mat-option",57),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"NO_RECORDS")," "))}function Ur(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PRODUCT_IS_REQUIRED")," "))}function Nr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Ur,3,3,"div",55),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("productId").errors?null:r.get("productId").errors.required)}}function Lr(e,n){if(1&e&&(t.TgZ(0,"mat-option",57),t._uU(1),t.qZA()),2&e){const r=n.$implicit;t.Q6J("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function Dr(e,n){if(1&e&&(t.TgZ(0,"mat-option",56),t._uU(1),t.qZA()),2&e){const r=n.$implicit,a=t.oxw(2);t.Q6J("dir",a.langDir)("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function Er(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT_IS_REQUIRED")," "))}function qr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Er,3,3,"div",55),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("unitId").errors?null:r.get("unitId").errors.required)}}function br(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"UNIT_PER_PRICE_IS_REQUIRED")," "))}function yr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"PRICE_SHOULD_BE_MORE_THEN_0")," "))}function Rr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,br,3,3,"div",55),t.YNc(2,yr,3,3,"div",55),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("unitPrice").errors?null:r.get("unitPrice").errors.required),t.xp6(1),t.Q6J("ngIf",null==r.get("unitPrice").errors?null:r.get("unitPrice").errors.min)}}function Yr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY_IS_REQUIRED")," "))}function Qr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"QUANTITY_SHOULD_BE_MORE_THEN_0")," "))}function Pr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,Yr,3,3,"div",55),t.YNc(2,Qr,3,3,"div",55),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("quantity").errors?null:r.get("quantity").errors.required),t.xp6(1),t.Q6J("ngIf",null==r.get("quantity").errors?null:r.get("quantity").errors.min)}}function wr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"DISCOUNT_SHOULD_BE_MORE_THEN_0")," "))}function Fr(e,n){if(1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"customCurrency"),t.ALo(4,"quantitiesunitpriceTax"),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.AsE(" ",t.lcZ(2,2,"DISCOUNT_AMOUNT"),": ",t.lcZ(3,4,t.Dn7(4,6,r.get("quantity").value,r.get("unitPrice").value,r.get("discountPercentage").value))," ")}}function Jr(e,n){if(1&e&&(t.TgZ(0,"mat-option",56),t._uU(1),t.qZA()),2&e){const r=n.$implicit,a=t.oxw(2);t.Q6J("dir",a.langDir)("value",r.id),t.xp6(1),t.AsE("",r.name," (",r.percentage,"%) ")}}function jr(e,n){1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&e&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"TAX_IS_REQUIRED")," "))}function Mr(e,n){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,jr,3,3,"div",55),t.qZA()),2&e){const r=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",null==r.get("taxValue").errors?null:r.get("taxValue").errors.required)}}const W=function(e,n,r,a,o){return[e,n,r,a,o]};function Br(e,n){if(1&e&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.ALo(3,"customCurrency"),t.ALo(4,"quantitiesunitpriceTax"),t.qZA()),2&e){const r=t.oxw(),a=r.$implicit,o=r.index,i=t.oxw();t.xp6(1),t.AsE(" ",t.lcZ(2,2,"TAX_AMOUNT"),": ",t.lcZ(3,4,t.G7q(4,6,t.qbA(12,W,a.get("quantity").value,a.get("unitPrice").value,a.get("discountPercentage").value,a.get("taxValue").value,i.taxsMap[o])))," ")}}function kr(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"tr",58)(1,"td"),t.YNc(2,Sr,3,0,"button",59),t.qZA(),t.TgZ(3,"td")(4,"mat-select",60),t.NdJ("selectionChange",function(o){const l=t.CHM(r).index,u=t.oxw();return t.KtG(u.onProductSelectionChange(o.value,l))}),t.ALo(5,"translate"),t._UZ(6,"input",61),t.ALo(7,"translate"),t._UZ(8,"mat-divider"),t.YNc(9,vr,2,3,"mat-option",21),t.YNc(10,Ir,3,3,"mat-option",22),t.qZA(),t.YNc(11,Nr,2,1,"div",10),t.qZA(),t.TgZ(12,"td")(13,"mat-select",62),t.YNc(14,Lr,2,2,"mat-option",63),t.qZA()(),t.TgZ(15,"td")(16,"mat-select",64),t.NdJ("selectionChange",function(o){const l=t.CHM(r).index,u=t.oxw();return t.KtG(u.onSelectionChange(o.value,l))}),t.YNc(17,Dr,2,3,"mat-option",21),t.qZA(),t.YNc(18,qr,2,1,"div",10),t.qZA(),t.TgZ(19,"td")(20,"input",65),t.NdJ("change",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.onUnitPriceChange())}),t.ALo(21,"translate"),t.qZA(),t.YNc(22,Rr,3,2,"div",10),t.qZA(),t.TgZ(23,"td")(24,"input",66),t.NdJ("change",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.onQuantityChange())}),t.ALo(25,"translate"),t.qZA(),t.YNc(26,Pr,3,2,"div",10),t.qZA(),t.TgZ(27,"td"),t._uU(28),t.ALo(29,"customCurrency"),t.ALo(30,"quantitiesunitprice"),t.qZA(),t.TgZ(31,"td")(32,"input",67),t.NdJ("change",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.onDiscountChange())}),t.ALo(33,"translate"),t.qZA(),t.YNc(34,wr,3,3,"div",55),t.qZA(),t.TgZ(35,"td"),t._uU(36),t.ALo(37,"customCurrency"),t.ALo(38,"quantitiesunitprice"),t.YNc(39,Fr,5,10,"div",55),t.qZA(),t.TgZ(40,"td")(41,"mat-select",68),t.NdJ("selectionChange",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.onTaxSelectionChange())}),t.ALo(42,"translate"),t.YNc(43,Jr,2,4,"mat-option",21),t.qZA(),t.YNc(44,Mr,2,1,"div",10),t.qZA(),t.TgZ(45,"td"),t._uU(46),t.ALo(47,"customCurrency"),t.ALo(48,"quantitiesunitprice"),t.YNc(49,Br,5,18,"div",55),t.qZA()()}if(2&e){const r=n.$implicit,a=n.index,o=t.oxw();t.Q6J("formGroupName",a),t.xp6(2),t.Q6J("ngIf",1!==(null==o.salesOrderItemsArray?null:o.salesOrderItemsArray.controls.length)),t.xp6(2),t.s9C("placeholder",t.lcZ(5,28,"SELECT_PRODUCT")),t.Q6J("dir",o.langDir),t.xp6(2),t.s9C("placeholder",t.lcZ(7,30,"SEARCH_OTHER_PRODUCTS")),t.xp6(3),t.Q6J("ngForOf",o.filterProductsMap[a]),t.xp6(1),t.Q6J("ngIf",0==o.filterProductsMap[a].length),t.xp6(1),t.Q6J("ngIf",r.get("productId").touched&&r.get("productId").errors),t.xp6(2),t.Q6J("dir",o.langDir),t.xp6(1),t.Q6J("ngForOf",o.warehouseMap[a]),t.xp6(2),t.Q6J("dir",o.langDir),t.xp6(1),t.Q6J("ngForOf",o.unitsMap[a]),t.xp6(1),t.Q6J("ngIf",r.get("unitId").touched&&r.get("unitId").errors),t.xp6(2),t.s9C("placeholder",t.lcZ(21,32,"UNIT_PER_PRICE")),t.xp6(2),t.Q6J("ngIf",r.get("unitPrice").touched&&r.get("unitPrice").errors),t.xp6(2),t.s9C("placeholder",t.lcZ(25,34,"QUANTITY")),t.xp6(2),t.Q6J("ngIf",r.get("quantity").touched&&r.get("quantity").errors),t.xp6(2),t.hij(" ",t.lcZ(29,36,t.xi3(30,38,r.get("quantity").value,r.get("unitPrice").value))," "),t.xp6(4),t.s9C("placeholder",t.lcZ(33,41,"DISCOUNT")),t.xp6(2),t.Q6J("ngIf",null==r.get("discountPercentage").errors?null:r.get("discountPercentage").errors.min),t.xp6(2),t.hij(" ",t.lcZ(37,43,t.Dn7(38,45,r.get("quantity").value,r.get("unitPrice").value,r.get("discountPercentage").value))," "),t.xp6(3),t.Q6J("ngIf",0!=r.get("discountPercentage").value),t.xp6(2),t.s9C("placeholder",t.lcZ(42,49,"SELECT_TAX")),t.Q6J("dir",o.langDir),t.xp6(2),t.Q6J("ngForOf",o.taxsMap[a]),t.xp6(1),t.Q6J("ngIf",r.get("taxValue").touched&&r.get("taxValue").errors),t.xp6(2),t.hij(" ",t.lcZ(47,51,t.G7q(48,53,t.qbA(59,W,r.get("quantity").value,r.get("unitPrice").value,r.get("discountPercentage").value,r.get("taxValue").value,o.taxsMap[a])))," "),t.xp6(3),t.Q6J("ngIf",r.get("taxValue").value)}}function Vr(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",71),t.NdJ("click",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.onSalesOrderSubmit())}),t._UZ(1,"i",72),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"SAVE"),""))}function $r(e,n){1&e&&t._UZ(0,"mat-spinner")}function Hr(e,n){if(1&e&&(t.TgZ(0,"div",73),t.YNc(1,$r,1,0,"mat-spinner",10),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.isLoading)}}const Gr=function(){return["SO_ADD_SO","SO_UPDATE_SO","SO_RETURN_SO"]};let Kr=(()=>{class e extends S.H{constructor(r,a,o,i,l,u,_,g,J,Na,tt,La){super(tt),this.fb=r,this.customerService=a,this.toastrService=o,this.salesOrderService=i,this.router=l,this.taxService=u,this.productService=_,this.route=g,this.quantitiesUnitPricePipe=J,this.quantitiesUnitPriceTaxPipe=Na,this.translationService=tt,this.unitConversationService=La,this.products=[],this.customers=[],this.warehouseList=[],this.isLoading=!1,this.isCustomerLoading=!1,this.filterProductsMap={},this.unitsMap={},this.warehouseMap={},this.unitConversationlist=[],this.taxsMap={},this.totalBeforeDiscount=0,this.totalAfterDiscount=0,this.totalDiscount=0,this.grandTotal=0,this.totalTax=0,this.isEdit=!1,this.getLangDir(),this.customerResource=new ir.H,this.productResource=new cr.f}get salesOrderItemsArray(){return this.salesOrderForm.get("salesOrderItems")}ngOnInit(){this.unitConversationlist=[...this.route.snapshot.data.units],this.warehouseList=[...this.route.snapshot.data.warehouses],this.getSalesOrderById(),this.createSalesOrder(),this.customerNameChangeValue(),this.getNewSalesOrderNumber(),this.getTaxes(),this.getProductByBarCodeValue()}onFilterValue(r){console.log(r)}getTaxes(){this.taxes$=this.taxService.entities$}createSalesOrder(){this.route.data.pipe().subscribe(r=>{this.salesOrder=r.salesorder,this.salesOrder?(this.isEdit=!0,this.salesOrderForm=this.fb.group({orderNumber:[this.salesOrder.orderNumber,[c.kI.required]],filerCustomer:[""],deliveryDate:[this.salesOrder.deliveryDate,[c.kI.required]],soCreatedDate:[this.salesOrder.soCreatedDate,[c.kI.required]],deliveryStatus:[this.salesOrder.deliveryStatus],customerId:[this.salesOrder.customerId,[c.kI.required]],note:[this.salesOrder.note],filterBarCodeValue:[""],termAndCondition:[this.salesOrder.termAndCondition],salesOrderItems:this.fb.array([])}),this.salesOrder.salesOrderItems.forEach(a=>{this.salesOrderItemsArray.push(this.createSalesOrderItemPatch(this.salesOrderItemsArray.length,a))}),this.getCustomers(),this.getAllTotal()):(this.isEdit=!1,this.getCustomers(),this.salesOrderForm=this.fb.group({orderNumber:["",[c.kI.required]],filerCustomer:[""],deliveryDate:[new Date,[c.kI.required]],soCreatedDate:[new Date,[c.kI.required]],deliveryStatus:[1],customerId:["",[c.kI.required]],note:[""],filterBarCodeValue:[""],termAndCondition:[""],salesOrderItems:this.fb.array([])}),this.salesOrderItemsArray.push(this.createSalesOrderItem(this.salesOrderItemsArray.length)))})}getProductByBarCodeValue(){this.sub$.sink=this.salesOrderForm.get("filterBarCodeValue").valueChanges.pipe((0,Z.b)(500),(0,A.x)(),(0,C.w)(r=>r?(this.productResource.barcode=r,this.productService.getProducts(this.productResource)):(0,dr.of)([]))).subscribe(r=>{if(r&&r.headers){if(1==r.body.length){1==this.salesOrderItemsArray.length&&(this.salesOrderItemsArray.controls[0].get("productId").value||this.onRemoveSalesOrderItem(0));const o=r.body[0].id;let i=this.salesOrderItemsArray.value;var a=i.findIndex(l=>l.productId==o);if(a>=0){let l=i[a];this.salesOrderItemsArray.at(a).get("quantity").patchValue(l.quantity+1)}else{this.onAddAnotherProduct();const l=this.salesOrderItemsArray.length-1;this.filterProductsMap[l.toString()]=[...r.body],this.onProductSelectionChange(o,l,!1)}this.getAllTotal()}else this.toastrService.warning("Product not found");this.productResource.barcode="",this.salesOrderForm.get("filterBarCodeValue").patchValue("")}},r=>{})}onAddAnotherProduct(){this.salesOrderItemsArray.push(this.createSalesOrderItem(this.salesOrderItemsArray.length))}createSalesOrderItemPatch(r,a){const o=a.salesOrderItemTaxes.map(l=>l.taxId),i=this.fb.group({productId:[a.productId,[c.kI.required]],filterProductValue:[""],unitPrice:[a.unitPrice,[c.kI.required]],quantity:[a.quantity,[c.kI.required]],taxValue:[o],unitId:[a.unitId,[c.kI.required]],warehouseId:[a.warehouseId],discountPercentage:[a.discountPercentage]});return this.unitsMap[r]=this.unitConversationlist.filter(l=>l.id==a.product.unitId||l.parentId==a.product.unitId),this.taxsMap[r]=[...this.route.snapshot.data.taxs],this.warehouseMap[r]=this.warehouseList,this.filterProductsMap[r.toString()]=[a.product],i}createSalesOrderItem(r){const a=this.fb.group({productId:["",[c.kI.required]],filterProductValue:[""],unitPrice:[0,[c.kI.required,c.kI.min(0)]],quantity:[1,[c.kI.required,c.kI.min(1)]],taxValue:[null],unitId:["",[c.kI.required]],warehouseId:[""],discountPercentage:[0,[c.kI.min(0)]]});return this.taxsMap[r]=[...this.route.snapshot.data.taxs],this.warehouseMap[r]=this.warehouseList,this.filterProductsMap[r.toString()]=[...this.route.snapshot.data.products],this.getProductByNameValue(a,r),a}getProductByNameValue(r,a){this.salesOrder&&this.getProducts(a),this.sub$.sink=r.get("filterProductValue").valueChanges.pipe((0,Z.b)(500),(0,A.x)(),(0,C.w)(o=>(this.productResource.name=o,this.productService.getProducts(this.productResource)))).subscribe(o=>{o&&o.headers&&(this.filterProductsMap[a.toString()]=[...o.body])},o=>{})}getAllTotal(){let r=this.salesOrderForm.get("salesOrderItems").value;this.totalBeforeDiscount=0,this.grandTotal=0,this.totalDiscount=0,this.totalTax=0,r&&r.length>0&&r.forEach(a=>{if(a.unitPrice&&a.quantity){const o=this.totalBeforeDiscount+parseFloat(this.quantitiesUnitPricePipe.transform(a.quantity,a.unitPrice));this.totalBeforeDiscount=parseFloat(o.toFixed(2));const i=this.grandTotal+parseFloat(this.quantitiesUnitPricePipe.transform(a.quantity,a.unitPrice,a.discountPercentage,a.taxValue,this.taxsMap[0]));this.grandTotal=parseFloat(i.toFixed(2));const l=this.totalTax+parseFloat(this.quantitiesUnitPriceTaxPipe.transform(a.quantity,a.unitPrice,a.discountPercentage,a.taxValue,this.taxsMap[0]));this.totalTax=parseFloat(l.toFixed(2));const u=this.totalDiscount+parseFloat(this.quantitiesUnitPriceTaxPipe.transform(a.quantity,a.unitPrice,a.discountPercentage));this.totalDiscount=parseFloat(u.toFixed(2))}})}onUnitPriceChange(){this.getAllTotal()}onQuantityChange(){this.getAllTotal()}onDiscountChange(){this.getAllTotal()}onTaxSelectionChange(){this.getAllTotal()}onRemoveSalesOrderItem(r){this.salesOrderItemsArray.removeAt(r),this.salesOrderItemsArray.controls.forEach((a,o)=>{const i=a.get("productId").value;i?this.salesOrder.salesOrderItems.map(l=>{l.product.id===i&&(this.products.find(u=>u.id===i)?this.getProducts(o):this.getProducts(o,i))}):this.getProducts(o)}),this.getAllTotal()}getProducts(r,a){0===this.products.length||a?(this.productResource.name="",this.productResource.id=a||"",this.productService.getProducts(this.productResource).subscribe(o=>{this.products=[...o.body],this.filterProductsMap[r.toString()]=[...o.body]},o=>{})):this.filterProductsMap[r.toString()]=[...this.products]}setUnitConversationForProduct(r,a){this.unitsMap[a]=this.unitConversationlist.filter(o=>o.id==r||o.parentId==r)}onSelectionChange(r,a,o=!0){const i=this.salesOrderItemsArray.controls[a].get("productId").value,l=this.filterProductsMap[a].find(g=>g.id===i),u=this.unitConversationlist.find(g=>g.id===r);let _=0;if(u.value){switch(u.operator){case L.d.Plush:_=l.salesPrice+parseFloat(u.value);break;case L.d.Minus:_=l.salesPrice-parseFloat(u.value);break;case L.d.Multiply:_=l.salesPrice*parseFloat(u.value);break;case L.d.Divide:_=l.salesPrice/parseFloat(u.value)}this.salesOrderItemsArray.controls[a].patchValue({unitPrice:_})}else this.salesOrderItemsArray.controls[a].patchValue({unitPrice:l.salesPrice,warehouseId:l.warehouseId})}onProductSelectionChange(r,a,o=!0){const i=this.filterProductsMap[a].find(l=>l.id===r);this.setUnitConversationForProduct(i.unitId,a),this.salesOrderItemsArray.controls[a].patchValue(o?{filterProductValue:"",unitPrice:""}:{productId:r}),this.salesOrderItemsArray.controls[a].patchValue({unitPrice:i.salesPrice,unitId:i.unitId,warehouseId:i.warehouseId}),i.productTaxes.length&&this.salesOrderItemsArray.controls[a].patchValue({taxValue:i.productTaxes.map(l=>l.taxId)}),this.getAllTotal()}getNewSalesOrderNumber(){this.salesOrderService.getNewSalesOrderNumber().subscribe(r=>{this.salesOrder||this.salesOrderForm.patchValue({orderNumber:r.orderNumber})})}customerNameChangeValue(){this.sub$.sink=this.salesOrderForm.get("filerCustomer").valueChanges.pipe((0,k.b)(r=>this.isCustomerLoading=!0),(0,Z.b)(500),(0,A.x)(),(0,C.w)(r=>(this.customerResource.customerName=r,this.customerResource.id=null,this.customerService.getCustomers(this.customerResource)))).subscribe(r=>{this.isCustomerLoading=!1,r&&r.headers&&(this.customers=[...r.body])},r=>{this.isCustomerLoading=!1})}getCustomers(){this.salesOrder?this.customerResource.id=this.salesOrder.customerId:(this.customerResource.customerName="",this.customerResource.id=null),this.customerService.getCustomers(this.customerResource).subscribe(r=>{r&&r.headers&&(this.customers=[...r.body])})}onSalesOrderSubmit(){if(this.salesOrderForm.valid){if(this.salesOrder&&this.salesOrder.salesOrderStatus===z.q.Return)return void this.toastrService.error(this.translationService.getValue("RETURN_SALES_ORDER_CANT_BE_EDIT"));const r=this.buildSalesOrder();r.id?this.salesOrderService.updateSalesOrder(r).subscribe(a=>{this.toastrService.success(this.translationService.getValue("SALES_ORDER_UPDATED_SUCCESSFULLY")),this.router.navigate(["/sales-order/list"])}):this.salesOrderService.addSalesOrder(r).subscribe(a=>{this.toastrService.success(this.translationService.getValue("SALES_ORDER_ADDED_SUCCESSFULLY")),this.router.navigate(["/sales-order/list"])})}else this.salesOrderForm.markAllAsTouched()}buildSalesOrder(){const r={id:this.salesOrder?this.salesOrder.id:"",orderNumber:this.salesOrderForm.get("orderNumber").value,deliveryDate:this.salesOrderForm.get("deliveryDate").value,deliveryStatus:lr.I.UnDelivery,isSalesOrderRequest:!1,soCreatedDate:this.salesOrderForm.get("soCreatedDate").value,salesOrderStatus:z.q.Not_Return,customerId:this.salesOrderForm.get("customerId").value,totalAmount:this.grandTotal,totalDiscount:this.totalDiscount,totalTax:this.totalTax,note:this.salesOrderForm.get("note").value,termAndCondition:this.salesOrderForm.get("termAndCondition").value,salesOrderItems:[]},a=this.salesOrderForm.get("salesOrderItems").value;return a&&a.length>0&&a.forEach(o=>{r.salesOrderItems.push({discount:parseFloat(this.quantitiesUnitPriceTaxPipe.transform(o.quantity,o.unitPrice,o.discountPercentage)),discountPercentage:o.discountPercentage,productId:o.productId,unitId:o.unitId,warehouseId:o.warehouseId,quantity:o.quantity,taxValue:parseFloat(this.quantitiesUnitPriceTaxPipe.transform(o.quantity,o.unitPrice,o.discountPercentage,o.taxValue,this.taxsMap[0])),unitPrice:parseFloat(o.unitPrice),salesOrderItemTaxes:o.taxValue?[...o.taxValue.map(i=>({taxId:i}))]:[]})}),r}onSalesOrderList(){this.router.navigate(["/sales-order/list"])}getSalesOrderById(){this.salesOrder=this.route.snapshot.data.salesorder}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(c.QS),t.Y36(V.v),t.Y36(R._W),t.Y36(v.V),t.Y36(p.F0),t.Y36(ur.D),t.Y36(mr.M),t.Y36(p.gz),t.Y36(w.q),t.Y36(P.S),t.Y36(I.D),t.Y36(_r.j))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sales-order-add-edit"]],features:[t._Bn([],[w.q,P.S]),t.qOj],decls:164,vars:118,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["autocomplete","off",3,"formGroup"],[1,"row"],[1,"col-md-3"],[1,"form-group"],[1,"text-danger"],["formControlName","orderNumber","type","text",1,"form-control","w-100",3,"readonly"],[4,"ngIf"],["for","soCreatedDate",1,"text-danger"],["id","soCreatedDate","formControlName","soCreatedDate",1,"form-control",3,"owlDateTimeTrigger","owlDateTime","placeholder"],[3,"pickerType"],["soCreatedDate",""],["for","deliveryDate",1,"text-danger"],["id","deliveryDate","formControlName","deliveryDate",1,"form-control",3,"owlDateTimeTrigger","owlDateTime","placeholder"],["deliveryDate",""],[1,"input-group"],["formControlName","customerId",1,"form-control",3,"dir","placeholder"],["formControlName","filerCustomer","focused","'true'","type","text","autocomplete","off",1,"form-control","w-100",3,"placeholder"],[3,"dir","value",4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],[1,"col-md-6"],["formControlName","termAndCondition",1,"form-control","w-100"],["formControlName","note",1,"form-control","w-100"],[1,"col-sm-12","col-md-12"],[1,"col-sm-6","col-md-6","col-lg-6"],["formControlName","filterBarCodeValue","type","text",1,"form-control","w-100",3,"placeholder"],["filterValue",""],["formArrayName","salesOrderItems",1,"col-sm-12"],[1,"col-sm-12","text-right","mb-2"],["type","button",1,"btn","blue-btn","btn-sm","m-right-10",3,"click"],[1,"fas","fa-plus"],[1,"col"],[1,"table-responsive"],[1,"table","table-bordered","table-hover","table-sm"],[1,"table-column-10"],[1,"table-column-200"],[1,"table-column-150"],[1,"table-column-130"],[1,"table-column-120"],[1,"table-column-100"],[1,"table-column-300"],[3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","mt-2"],[1,"col-10","text-right","font-weight-bold"],[1,"col-2","text-left","font-weight-bold"],[1,"col-2","text-left","text-danger","font-weight-bold"],[1,"col-12"],[1,"col-md-12","mb-1"],["type","button","class","btn btn-success btn-sm m-right-10",3,"click",4,"hasClaim"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-times-circle"],["class","loading-shade",4,"ngIf"],["class","text-danger",4,"ngIf"],[3,"dir","value"],[3,"value"],[3,"formGroupName"],["type","button","mat-icon-button","","aria-label","Action",3,"click",4,"ngIf"],["formControlName","productId",1,"form-control",3,"dir","placeholder","selectionChange"],["formControlName","filterProductValue","focused","'true'","type","text","autocomplete","off",1,"form-control","w-100",3,"placeholder"],["placeholder","Select Warehouse","formControlName","warehouseId",1,"form-control",3,"dir"],[3,"value",4,"ngFor","ngForOf"],["formControlName","unitId",1,"form-control",3,"dir","selectionChange"],["type","number","formControlName","unitPrice",1,"form-control",3,"placeholder","change"],["type","number","formControlName","quantity",1,"form-control",3,"placeholder","change"],["formControlName","discountPercentage",1,"form-control",3,"placeholder","change"],["formControlName","taxValue","multiple","",1,"form-control",3,"dir","placeholder","selectionChange"],["type","button","mat-icon-button","","aria-label","Action",3,"click"],[1,"btn-danger"],["type","button",1,"btn","btn-success","btn-sm","m-right-10",3,"click"],[1,"fas","fa-save"],[1,"loading-shade"]],template:function(r,a){if(1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()()()(),t.TgZ(7,"form",4)(8,"div",5)(9,"div",6)(10,"div",7)(11,"label",8),t._uU(12),t.ALo(13,"translate"),t.TgZ(14,"span"),t._uU(15,"*"),t.qZA()(),t._UZ(16,"input",9),t.YNc(17,hr,2,1,"div",10),t.qZA()(),t.TgZ(18,"div",6)(19,"div",7)(20,"label",11),t._uU(21),t.ALo(22,"translate"),t.qZA(),t._UZ(23,"input",12),t.ALo(24,"translate"),t.YNc(25,fr,2,1,"div",10),t._UZ(26,"owl-date-time",13,14),t.qZA()(),t.TgZ(28,"div",6)(29,"div",7)(30,"label",15),t._uU(31),t.ALo(32,"translate"),t.qZA(),t._UZ(33,"input",16),t.ALo(34,"translate"),t.YNc(35,Zr,2,1,"div",10),t._UZ(36,"owl-date-time",13,17),t.qZA()(),t.TgZ(38,"div",6)(39,"div",7)(40,"label",8),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"div",18)(44,"mat-select",19),t.ALo(45,"translate"),t._UZ(46,"input",20),t.ALo(47,"translate"),t._UZ(48,"mat-divider"),t.YNc(49,Ar,2,3,"mat-option",21),t.YNc(50,xr,3,3,"mat-option",22),t.qZA()(),t.YNc(51,Cr,2,1,"div",10),t.qZA()()(),t.TgZ(52,"div",5)(53,"div",23)(54,"div",7)(55,"label"),t._uU(56),t.ALo(57,"translate"),t.qZA(),t.TgZ(58,"div",18)(59,"textarea",24),t._uU(60,"            "),t.qZA()()()(),t.TgZ(61,"div",23)(62,"div",7)(63,"label"),t._uU(64),t.ALo(65,"translate"),t.qZA(),t.TgZ(66,"div",18)(67,"textarea",25),t._uU(68,"            "),t.qZA()()()()(),t.TgZ(69,"div",5)(70,"div",26)(71,"div",5)(72,"div",27)(73,"h6"),t._uU(74),t.ALo(75,"translate"),t.qZA(),t._UZ(76,"input",28,29),t.ALo(78,"translate"),t.qZA()()()(),t.TgZ(79,"div",5)(80,"div",30)(81,"div",5)(82,"div",31)(83,"button",32),t.NdJ("click",function(){return a.onAddAnotherProduct()}),t._UZ(84,"i",33),t._uU(85),t.ALo(86,"translate"),t.qZA()()(),t.TgZ(87,"div",5)(88,"div",34)(89,"div",35)(90,"table",36)(91,"tr")(92,"th",37),t._uU(93," \xa0 "),t.qZA(),t.TgZ(94,"th",38),t._uU(95),t.ALo(96,"translate"),t.qZA(),t.TgZ(97,"th",38),t._uU(98),t.ALo(99,"translate"),t.qZA(),t.TgZ(100,"th",39),t._uU(101),t.ALo(102,"translate"),t.qZA(),t.TgZ(103,"th",40),t._uU(104),t.ALo(105,"translate"),t.qZA(),t.TgZ(106,"th",41),t._uU(107),t.ALo(108,"translate"),t.qZA(),t.TgZ(109,"th",42),t._uU(110),t.ALo(111,"translate"),t.qZA(),t.TgZ(112,"th",42),t._uU(113),t.ALo(114,"translate"),t.qZA(),t.TgZ(115,"th",42),t._uU(116),t.ALo(117,"translate"),t.qZA(),t.TgZ(118,"th",43),t._uU(119),t.ALo(120,"translate"),t.qZA(),t.TgZ(121,"th",39),t._uU(122),t.ALo(123,"translate"),t.qZA()(),t.YNc(124,kr,50,65,"tr",44),t.qZA()()()()()(),t.TgZ(125,"div",45)(126,"div",46),t._uU(127),t.ALo(128,"translate"),t.qZA(),t.TgZ(129,"div",47),t._uU(130),t.ALo(131,"customCurrency"),t.qZA()(),t.TgZ(132,"div",5)(133,"div",46),t._uU(134),t.ALo(135,"translate"),t.qZA(),t.TgZ(136,"div",48),t._uU(137),t.ALo(138,"customCurrency"),t.qZA()(),t.TgZ(139,"div",5)(140,"div",46),t._uU(141),t.ALo(142,"translate"),t.qZA(),t.TgZ(143,"div",47),t._uU(144),t.ALo(145,"customCurrency"),t.qZA()(),t.TgZ(146,"div",5)(147,"div",49),t._UZ(148,"mat-divider"),t.qZA()(),t.TgZ(149,"div",5)(150,"div",46),t._uU(151),t.ALo(152,"translate"),t.qZA(),t.TgZ(153,"div",47),t._uU(154),t.ALo(155,"customCurrency"),t.qZA()(),t.TgZ(156,"div",5)(157,"div",50),t.YNc(158,Vr,4,3,"button",51),t.TgZ(159,"button",52),t.NdJ("click",function(){return a.onSalesOrderList()}),t._UZ(160,"i",53),t._uU(161),t.ALo(162,"translate"),t.qZA()()()(),t.YNc(163,Hr,2,1,"div",54)),2&r){const o=t.MAs(27),i=t.MAs(37);t.xp6(5),t.Oqu(t.lcZ(6,51,"MANAGE_SALES_ORDERS")),t.xp6(2),t.Q6J("formGroup",a.salesOrderForm),t.xp6(5),t.hij("",t.lcZ(13,53,"SO_NUMBER")," "),t.xp6(4),t.Q6J("readonly",a.isEdit),t.xp6(1),t.Q6J("ngIf",a.salesOrderForm.get("orderNumber").touched&&a.salesOrderForm.get("orderNumber").errors),t.xp6(4),t.hij("",t.lcZ(22,55,"ORDER_DATE")," *"),t.xp6(2),t.s9C("placeholder",t.lcZ(24,57,"DELIVERY_DATE")),t.Q6J("owlDateTimeTrigger",o)("owlDateTime",o),t.xp6(2),t.Q6J("ngIf",a.salesOrderForm.get("soCreatedDate").touched&&a.salesOrderForm.get("soCreatedDate").errors),t.xp6(1),t.Q6J("pickerType","calendar"),t.xp6(5),t.hij("",t.lcZ(32,59,"DELIVERY_DATE")," *"),t.xp6(2),t.s9C("placeholder",t.lcZ(34,61,"DELIVERY_DATE")),t.Q6J("owlDateTimeTrigger",i)("owlDateTime",i),t.xp6(2),t.Q6J("ngIf",a.salesOrderForm.get("deliveryDate").touched&&a.salesOrderForm.get("deliveryDate").errors),t.xp6(1),t.Q6J("pickerType","calendar"),t.xp6(5),t.hij("",t.lcZ(42,63,"CUSTOMER_NAME")," *"),t.xp6(3),t.MGl("placeholder","",t.lcZ(45,65,"SELECT_CUSTOMER")," "),t.Q6J("dir",a.langDir),t.xp6(2),t.s9C("placeholder",t.lcZ(47,67,"SEARCH_OTHER_CUSTOMERS")),t.xp6(3),t.Q6J("ngForOf",a.customers),t.xp6(1),t.Q6J("ngIf",0==a.customers.length),t.xp6(1),t.Q6J("ngIf",a.salesOrderForm.get("customerId").touched&&a.salesOrderForm.get("customerId").errors),t.xp6(5),t.hij("",t.lcZ(57,69,"TERM_AND_CONDITION")," "),t.xp6(8),t.hij("",t.lcZ(65,71,"NOTES")," "),t.xp6(10),t.Oqu(t.lcZ(75,73,"SCAN_BARCODE")),t.xp6(2),t.s9C("placeholder",t.lcZ(78,75,"SCAN_BARCODE")),t.xp6(9),t.hij(" ",t.lcZ(86,77,"ADD_ANOTHER_PRODUCT")," "),t.xp6(10),t.hij(" ",t.lcZ(96,79,"PRODUCT")," "),t.xp6(3),t.hij(" ",t.lcZ(99,81,"WAREHOUSE")," "),t.xp6(3),t.hij(" ",t.lcZ(102,83,"UNIT")," "),t.xp6(3),t.hij(" ",t.lcZ(105,85,"PRICE")," "),t.xp6(3),t.hij(" ",t.lcZ(108,87,"QUANTITY")," "),t.xp6(3),t.hij(" ",t.lcZ(111,89,"SUBTOTAL_BEFORE_DISCOUNT")," "),t.xp6(3),t.hij(" ",t.lcZ(114,91,"DISCOUNT"),"% "),t.xp6(3),t.hij(" ",t.lcZ(117,93,"SUBTOTAL_AFTER_DISCOUNT")," "),t.xp6(3),t.hij(" ",t.lcZ(120,95,"TAX")," "),t.xp6(3),t.hij(" ",t.lcZ(123,97,"TOTAL")," "),t.xp6(2),t.Q6J("ngForOf",null==a.salesOrderItemsArray?null:a.salesOrderItemsArray.controls),t.xp6(3),t.hij(" ",t.lcZ(128,99,"SUB_TOTAL_BEFORE_DISCOUNT"),": "),t.xp6(3),t.hij(" ",t.lcZ(131,101,a.totalBeforeDiscount)," "),t.xp6(4),t.hij(" ",t.lcZ(135,103,"TOTAL_DISCOUNT"),": "),t.xp6(3),t.hij(" ",t.lcZ(138,105,a.totalDiscount)," "),t.xp6(4),t.hij(" ",t.lcZ(142,107,"TOTAL_TAX"),": "),t.xp6(3),t.hij(" ",t.lcZ(145,109,a.totalTax)," "),t.xp6(7),t.hij(" ",t.lcZ(152,111,"GRAND_TOTAL")," : "),t.xp6(3),t.hij(" ",t.lcZ(155,113,a.grandTotal)," "),t.xp6(4),t.Q6J("hasClaim",t.DdM(117,Gr)),t.xp6(3),t.hij(" ",t.lcZ(162,115,"CANCEL")," "),t.xp6(2),t.Q6J("ngIf",a.isLoading)}},dependencies:[m.sg,m.O5,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,Y.d,Q.Lv,M.gD,D.ey,q.Hw,b.lW,f.Ou,O.sZ,O.BO,O.hV,B.d,U.R,N.X$,w.q,P.S]}),e})();var F=s(319),Xr=s(7286),zr=s(3349),Wr=s(8394),ta=s(9147),ea=s(130),ra=s(7432);function aa(e,n){if(1&e){const r=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.generateInvoice())}),t._UZ(1,"i",8),t._uU(2),t.ALo(3,"translate"),t.qZA()}2&e&&(t.xp6(2),t.hij(" ",t.lcZ(3,1,"GENERATE_INVOICE")," "))}function na(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"a",35),t._uU(2),t.qZA(),t.BQk()),2&e){const r=t.oxw(2);t.xp6(1),t.MGl("href","mailto:",null==r.salesOrder||null==r.salesOrder.customer?null:r.salesOrder.customer.email,"",t.LSH),t.xp6(1),t.Oqu(null==r.salesOrder||null==r.salesOrder.customer?null:r.salesOrder.customer.email)}}function oa(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"a",35),t._uU(2),t.qZA(),t.BQk()),2&e){const r=t.oxw(2);t.xp6(1),t.MGl("href","mailto:",r.companyProfile.email,"",t.LSH),t.xp6(1),t.Oqu(r.companyProfile.email)}}function sa(e,n){1&e&&(t.TgZ(0,"span"),t._uU(1,", "),t.qZA())}function ia(e,n){if(1&e&&(t.TgZ(0,"span",38),t._uU(1),t.YNc(2,sa,2,0,"span",5),t.qZA()),2&e){const r=n.$implicit,a=n.last;t.xp6(1),t.AsE(" ",r.taxName,"(",r.taxPercentage,"%) "),t.xp6(1),t.Q6J("ngIf",!a)}}function la(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"td",36),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",37),t._uU(6),t.ALo(7,"customCurrency"),t.qZA(),t.TgZ(8,"td",37),t._uU(9),t.TgZ(10,"span",38),t._uU(11),t.qZA()(),t.TgZ(12,"td",37),t._uU(13),t.ALo(14,"customCurrency"),t.qZA(),t.TgZ(15,"td",37),t._uU(16),t.ALo(17,"customCurrency"),t._UZ(18,"br"),t.YNc(19,ia,3,3,"span",39),t.qZA(),t.TgZ(20,"td",37),t._uU(21),t.ALo(22,"customCurrency"),t.qZA(),t.BQk()),2&e){const r=t.oxw(),a=r.index,o=r.$implicit;t.xp6(2),t.Oqu(a+1),t.xp6(2),t.Oqu(o.productName),t.xp6(2),t.Oqu(t.lcZ(7,9,o.unitPrice)),t.xp6(3),t.hij("",o.quantity," "),t.xp6(2),t.hij("(",null==o||null==o.unitConversation?null:o.unitConversation.name,")"),t.xp6(2),t.Oqu(t.lcZ(14,11,o.discount)),t.xp6(3),t.Oqu(t.lcZ(17,13,o.taxValue)),t.xp6(3),t.Q6J("ngForOf",o.salesOrderItemTaxes),t.xp6(2),t.hij(" ",t.lcZ(22,15,(null==o?null:o.quantity)*(null==o?null:o.unitPrice)-o.discount+o.taxValue)," ")}}function ca(e,n){if(1&e&&(t.TgZ(0,"tr"),t.YNc(1,la,23,17,"ng-container",5),t.qZA()),2&e){const r=n.$implicit;t.xp6(1),t.Q6J("ngIf",0==r.status)}}function da(e,n){1&e&&(t.TgZ(0,"tr",40)(1,"td",41)(2,"strong"),t._uU(3,"Returned Items"),t.qZA()()())}function ua(e,n){1&e&&(t.TgZ(0,"span"),t._uU(1,", "),t.qZA())}function ma(e,n){if(1&e&&(t.TgZ(0,"span",38),t._uU(1),t.YNc(2,ua,2,0,"span",5),t.qZA()),2&e){const r=n.$implicit,a=n.last;t.xp6(1),t.AsE(" ",r.taxName,"(",r.taxPercentage,"%) "),t.xp6(1),t.Q6J("ngIf",!a)}}function _a(e,n){if(1&e&&(t.TgZ(0,"tr",40)(1,"td",36),t._uU(2),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td",37),t._uU(6),t.ALo(7,"customCurrency"),t.qZA(),t.TgZ(8,"td",37),t._uU(9),t._UZ(10,"br"),t.TgZ(11,"span",38),t._uU(12),t.qZA()(),t.TgZ(13,"td",37),t._uU(14),t.ALo(15,"customCurrency"),t.qZA(),t.TgZ(16,"td",37),t._uU(17),t.ALo(18,"customCurrency"),t._UZ(19,"br"),t.YNc(20,ma,3,3,"span",39),t.qZA(),t.TgZ(21,"td",37),t._uU(22),t.ALo(23,"customCurrency"),t.qZA()()),2&e){const r=n.$implicit,a=n.index;t.xp6(2),t.Oqu(a+1),t.xp6(2),t.Oqu(r.productName),t.xp6(2),t.Oqu(t.lcZ(7,9,r.unitPrice)),t.xp6(3),t.Oqu(-1*r.quantity),t.xp6(3),t.hij("(",null==r||null==r.unitConversation?null:r.unitConversation.name,")"),t.xp6(2),t.Oqu(t.lcZ(15,11,-1*r.discount)),t.xp6(3),t.Oqu(t.lcZ(18,13,-1*r.taxValue)),t.xp6(3),t.Q6J("ngForOf",r.salesOrderItemTaxes),t.xp6(2),t.hij(" ",t.lcZ(23,15,-1*((null==r?null:r.quantity)*(null==r?null:r.unitPrice)-r.discount+r.taxValue))," ")}}function pa(e,n){if(1&e&&(t.TgZ(0,"tr")(1,"td",18),t._uU(2),t.ALo(3,"utcToLocalTime"),t.qZA(),t.TgZ(4,"td",18),t._uU(5),t.ALo(6,"customCurrency"),t.qZA(),t.TgZ(7,"td",18),t._uU(8),t.qZA(),t.TgZ(9,"td",18),t._uU(10),t.ALo(11,"paymentmethod"),t.qZA()()),2&e){const r=n.$implicit;t.xp6(2),t.Oqu(t.xi3(3,4,r.paymentDate,"shortDate")),t.xp6(3),t.Oqu(t.lcZ(6,7,r.amount)),t.xp6(3),t.Oqu(r.referenceNumber),t.xp6(2),t.Oqu(t.lcZ(11,9,r.paymentMethod))}}function ha(e,n){if(1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h1"),t._uU(6),t.ALo(7,"translate"),t.qZA()()()()(),t._UZ(8,"br"),t.TgZ(9,"div",16)(10,"table",42)(11,"thead",18)(12,"tr")(13,"th"),t._uU(14),t.ALo(15,"translate"),t.qZA(),t.TgZ(16,"th"),t._uU(17),t.ALo(18,"translate"),t.qZA(),t.TgZ(19,"th"),t._uU(20),t.ALo(21,"translate"),t.qZA(),t.TgZ(22,"th"),t._uU(23),t.ALo(24,"translate"),t.qZA()()(),t.TgZ(25,"tbody"),t.YNc(26,pa,12,11,"tr",25),t.qZA()()()()),2&e){const r=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,6,"SALES_ORDER_PAYMENTS")),t.xp6(8),t.Oqu(t.lcZ(15,8,"PAYMENT_DATE")),t.xp6(3),t.Oqu(t.lcZ(18,10,"AMOUNT")),t.xp6(3),t.Oqu(t.lcZ(21,12,"REFERENCE_NUMBER")),t.xp6(3),t.Oqu(t.lcZ(24,14,"PAID_BY")),t.xp6(3),t.Q6J("ngForOf",r.salesOrder.salesOrderPayments)}}function ga(e,n){if(1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h1"),t._uU(6),t.ALo(7,"translate"),t.qZA()()()()(),t._UZ(8,"br"),t.TgZ(9,"div",9)(10,"div",43)(11,"div",11),t._uU(12),t._UZ(13,"br")(14,"div",13),t.qZA()()()()),2&e){const r=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,2,"TERMS_AND_CONDITION")),t.xp6(6),t.hij(" ",null==r.salesOrder?null:r.salesOrder.termAndCondition,"")}}function fa(e,n){if(1&e&&(t.TgZ(0,"div")(1,"div",0)(2,"div",1)(3,"div",2)(4,"div",3)(5,"h1"),t._uU(6),t.ALo(7,"translate"),t.qZA()()()()(),t._UZ(8,"br"),t.TgZ(9,"div",9)(10,"div",43)(11,"div",11),t._uU(12),t._UZ(13,"br")(14,"div",13),t.qZA()()()()),2&e){const r=t.oxw(2);t.xp6(6),t.Oqu(t.lcZ(7,2,"NOTE")),t.xp6(6),t.hij(" ",null==r.salesOrder?null:r.salesOrder.note,"")}}const Oa=function(e,n,r){return{"badge-success":e,"badge-danger":n,"badge-warning":r}};function Za(e,n){if(1&e){const r=t.EpF();t.ynx(0),t.TgZ(1,"div",9)(2,"div",10)(3,"div",11)(4,"h5",12),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"b"),t._uU(8),t.qZA(),t._UZ(9,"br"),t._uU(10),t._UZ(11,"br")(12,"br"),t._uU(13),t.ALo(14,"translate"),t._UZ(15,"br"),t._uU(16),t.ALo(17,"translate"),t.YNc(18,na,3,2,"ng-container",5),t._UZ(19,"div",13),t.qZA()(),t.TgZ(20,"div",14)(21,"div",11)(22,"h5",12),t._uU(23),t.ALo(24,"translate"),t.qZA(),t.TgZ(25,"b"),t._uU(26),t.qZA(),t._UZ(27,"br"),t._uU(28),t._UZ(29,"br")(30,"br"),t._uU(31),t.ALo(32,"translate"),t._UZ(33,"br"),t._uU(34),t.ALo(35,"translate"),t.YNc(36,oa,3,2,"ng-container",5),t._UZ(37,"div",13),t.qZA()(),t.TgZ(38,"div",14)(39,"div",11)(40,"h5",12),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"b"),t._uU(44),t.qZA(),t._UZ(45,"br"),t.TgZ(46,"b"),t._uU(47),t.ALo(48,"translate"),t.qZA(),t._uU(49),t.ALo(50,"utcToLocalTime"),t._UZ(51,"br"),t.TgZ(52,"b"),t._uU(53),t.ALo(54,"translate"),t.qZA(),t.TgZ(55,"span",15),t._uU(56),t.ALo(57,"paymentStatus"),t.qZA(),t._UZ(58,"div",13),t.qZA()()(),t.TgZ(59,"div",0)(60,"div",1)(61,"div",2)(62,"div",3)(63,"h1"),t._uU(64),t.ALo(65,"translate"),t.qZA()()()()(),t._UZ(66,"br"),t.TgZ(67,"div",16)(68,"table",17)(69,"thead",18)(70,"tr")(71,"th",19),t._uU(72),t.ALo(73,"translate"),t.qZA(),t.TgZ(74,"th",20),t._uU(75),t.ALo(76,"translate"),t.qZA(),t.TgZ(77,"th",21),t._uU(78),t.ALo(79,"translate"),t.qZA(),t.TgZ(80,"th",22),t._uU(81),t.ALo(82,"translate"),t.qZA(),t.TgZ(83,"th",21),t._uU(84),t.ALo(85,"translate"),t.qZA(),t.TgZ(86,"th",23),t._uU(87),t.ALo(88,"translate"),t.qZA(),t.TgZ(89,"th",24),t._uU(90),t.ALo(91,"translate"),t.qZA()()(),t.TgZ(92,"tbody"),t.YNc(93,ca,2,1,"tr",25),t.YNc(94,da,4,0,"tr",26),t.YNc(95,_a,24,17,"tr",27),t.TgZ(96,"tr")(97,"td",28),t._uU(98),t.ALo(99,"translate"),t.qZA(),t.TgZ(100,"td",29),t._uU(101),t.ALo(102,"customCurrency"),t.qZA(),t.TgZ(103,"td",29),t._uU(104),t.ALo(105,"customCurrency"),t.qZA(),t.TgZ(106,"td",30),t._uU(107),t.ALo(108,"customCurrency"),t.qZA()(),t.TgZ(109,"tr")(110,"td",31),t._uU(111),t.ALo(112,"translate"),t.qZA(),t.TgZ(113,"td",30),t._uU(114),t.ALo(115,"customCurrency"),t.qZA()(),t.TgZ(116,"tr")(117,"td",31),t._uU(118),t.ALo(119,"translate"),t.qZA(),t.TgZ(120,"td",30),t._uU(121),t.ALo(122,"customCurrency"),t.qZA()()()()(),t.YNc(123,ha,27,16,"div",5),t.YNc(124,ga,15,4,"div",5),t.YNc(125,fa,15,4,"div",5),t.TgZ(126,"div",9)(127,"div",32)(128,"button",33),t.NdJ("click",function(){t.CHM(r);const o=t.oxw();return t.KtG(o.cancel())}),t._UZ(129,"i",34),t._uU(130),t.ALo(131,"translate"),t.qZA()()(),t.BQk()}if(2&e){const r=t.oxw();t.xp6(5),t.Oqu(t.lcZ(6,44,"CUSTOMER_ADDRESS")),t.xp6(3),t.hij(" ",null==r.salesOrder||null==r.salesOrder.customer?null:r.salesOrder.customer.customerName,""),t.xp6(2),t.hij(" ",null==r.salesOrder||null==r.salesOrder.customer?null:r.salesOrder.customer.address,""),t.xp6(3),t.AsE("",t.lcZ(14,46,"PHONE"),": ",null==r.salesOrder||null==r.salesOrder.customer?null:r.salesOrder.customer.mobileNo,""),t.xp6(3),t.hij("",t.lcZ(17,48,"EMAIL"),": "),t.xp6(2),t.Q6J("ngIf",null==r.salesOrder||null==r.salesOrder.customer?null:r.salesOrder.customer.email),t.xp6(5),t.Oqu(t.lcZ(24,50,"COMPANY_PROFILE")),t.xp6(3),t.hij(" ",r.companyProfile.title,""),t.xp6(2),t.hij(" ",r.companyProfile.address,""),t.xp6(3),t.AsE("",t.lcZ(32,52,"PHONE"),": ",r.companyProfile.phone,""),t.xp6(3),t.hij("",t.lcZ(35,54,"EMAIL"),": "),t.xp6(2),t.Q6J("ngIf",r.companyProfile.email),t.xp6(5),t.Oqu(t.lcZ(42,56,"REFERENCE")),t.xp6(3),t.hij(" ",null==r.salesOrder?null:r.salesOrder.orderNumber,""),t.xp6(3),t.hij("",t.lcZ(48,58,"DATE")," : "),t.xp6(2),t.hij("",t.xi3(50,60,null==r.salesOrder?null:r.salesOrder.soCreatedDate,"shortDate")," "),t.xp6(4),t.hij("",t.lcZ(54,63,"PAYMENT_STATUS")," : "),t.xp6(2),t.Q6J("ngClass",t.kEZ(101,Oa,0==(null==r.salesOrder?null:r.salesOrder.paymentStatus),1==(null==r.salesOrder?null:r.salesOrder.paymentStatus),2==(null==r.salesOrder?null:r.salesOrder.paymentStatus))),t.xp6(1),t.hij(" ",t.lcZ(57,65,null==r.salesOrder?null:r.salesOrder.paymentStatus),""),t.xp6(8),t.Oqu(t.lcZ(65,67,"SALES_ORDER_ITEMS")),t.xp6(8),t.Oqu(t.lcZ(73,69,"NO.")),t.xp6(3),t.Oqu(t.lcZ(76,71,"DESCRIPTION")),t.xp6(3),t.Oqu(t.lcZ(79,73,"UNIT_PRICE")),t.xp6(3),t.Oqu(t.lcZ(82,75,"QUANTITY")),t.xp6(3),t.Oqu(t.lcZ(85,77,"DISCOUNT")),t.xp6(3),t.Oqu(t.lcZ(88,79,"TAX")),t.xp6(3),t.Oqu(t.lcZ(91,81,"TOTAL_AMOUNT")),t.xp6(3),t.Q6J("ngForOf",r.salesOrderItems),t.xp6(1),t.Q6J("ngIf",(null==r.salesOrderReturnsItems?null:r.salesOrderReturnsItems.length)>0),t.xp6(1),t.Q6J("ngForOf",r.salesOrderReturnsItems),t.xp6(3),t.Oqu(t.lcZ(99,83,"TOTAL")),t.xp6(3),t.Oqu(t.lcZ(102,85,r.salesOrder.totalDiscount)),t.xp6(3),t.Oqu(t.lcZ(105,87,r.salesOrder.totalTax)),t.xp6(3),t.Oqu(t.lcZ(108,89,r.salesOrder.totalAmount)),t.xp6(4),t.Oqu(t.lcZ(112,91,"PAID")),t.xp6(3),t.hij("",t.lcZ(115,93,r.salesOrder.totalPaidAmount)," "),t.xp6(4),t.Oqu(t.lcZ(119,95,"BALANCE")),t.xp6(3),t.Oqu(t.lcZ(122,97,r.salesOrder.totalAmount-r.salesOrder.totalPaidAmount)),t.xp6(2),t.Q6J("ngIf",r.salesOrder.salesOrderPayments.length>0),t.xp6(1),t.Q6J("ngIf",r.salesOrder.termAndCondition),t.xp6(1),t.Q6J("ngIf",r.salesOrder.note),t.xp6(5),t.hij(" ",t.lcZ(131,99,"CANCEL")," ")}}function Aa(e,n){1&e&&t._UZ(0,"mat-spinner")}function xa(e,n){if(1&e&&(t.TgZ(0,"div",44),t.YNc(1,Aa,1,0,"mat-spinner",5),t.qZA()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("ngIf",r.isLoading)}}function Ta(e,n){if(1&e&&(t.ynx(0),t._UZ(1,"app-sales-order-invoice",45),t.BQk()),2&e){const r=t.oxw();t.xp6(1),t.Q6J("salesOrder",r.salesOrderForInvoice)}}let Ca=(()=>{class e extends S.H{constructor(r,a,o,i,l,u,_){super(_),this.salesOrderService=r,this.routes=a,this.clonerService=o,this.toastrService=i,this.location=l,this.securityService=u,this.translationService=_,this.currentDate=new Date,this.quantitesErrormsg="",this.errorMsg="",this.isLoading=!1,this.salesOrder=null}ngOnInit(){this.getCustomerOrderById(),this.subScribeCompanyProfile()}getCustomerOrderById(){this.sub$.sink=this.routes.params.subscribe(r=>{this.getSalesOrderById(r.id)})}subScribeCompanyProfile(){this.securityService.companyProfile.subscribe(r=>{this.companyProfile=r})}getSalesOrderById(r){this.isLoading=!0,this.salesOrderService.getSalesOrderById(r).subscribe(a=>{this.salesOrder=this.clonerService.deepClone(a),this.salesOrder.totalQuantity=this.salesOrder.salesOrderItems.map(o=>1==o.status?-1*o.quantity:o.quantity).reduce((o,i)=>o+i),this.salesOrderItems=this.salesOrder.salesOrderItems.filter(o=>0==o.status),this.salesOrderReturnsItems=this.salesOrder.salesOrderItems.filter(o=>1==o.status),this.isLoading=!1},a=>{this.isLoading=!1})}generateInvoice(){let r=this.clonerService.deepClone(this.salesOrder);r.salesOrderItems.map(a=>{var o;return a.unitName=null===(o=a.unitConversation)||void 0===o?void 0:o.name,a}),this.salesOrderForInvoice=r}downloadFile(r,a){const o=new Blob([r.body],{type:r.body.type}),i=document.createElement("a");i.setAttribute("style","display:none;"),document.body.appendChild(i),i.download=a,i.href=URL.createObjectURL(o),i.target="_blank",i.click(),document.body.removeChild(i)}cancel(){this.location.back()}}return e.\u0275fac=function(r){return new(r||e)(t.Y36(v.V),t.Y36(p.gz),t.Y36($.$),t.Y36(R._W),t.Y36(m.Ye),t.Y36(ea.I),t.Y36(I.D))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-sales-order-detail"]],features:[t.qOj],decls:13,vars:8,consts:[[1,"page-header-main"],[1,"row","align-items-center","justify-content-between"],[1,"col-md-auto","col-sm-auto"],[1,"content-header"],["class","btn blue-btn btn-sm m-right-10",3,"click",4,"hasClaim"],[4,"ngIf"],["class","loading-shade",4,"ngIf"],[1,"btn","blue-btn","btn-sm","m-right-10",3,"click"],[1,"fas","fa-receipt"],[1,"row"],[1,"col-sm-4"],[1,"form-group"],[1,""],[1,"clearfix"],[1,"col-md-4"],[1,"badge-pill",3,"ngClass"],[1,"table-responsive"],[1,"table","table-bordered","table-hover","table-striped","table-sm"],[1,"head"],[2,"width","1%"],[2,"width","20%"],[2,"width","3%"],[2,"width","2%"],[2,"width","5%"],[2,"width","10%"],[4,"ngFor","ngForOf"],["class","bg-warning1",4,"ngIf"],["class","bg-warning1",4,"ngFor","ngForOf"],["colspan","4",1,"text-right","total"],[1,"text-right","total"],[1,"total"],["colspan","6",1,"text-right","total"],[1,"col-md-12","mb-1"],["type","button",1,"btn","btn-danger","btn-sm",3,"click"],[1,"fas","fa-times-circle"],[3,"href"],[2,"text-align","center"],[1,"text-right"],[2,"font-size","10px"],["style","font-size: 10px;",4,"ngFor","ngForOf"],[1,"bg-warning1"],["colspan","100%",1,"no-border"],[1,"table","table-bordered","table-hover","table-striped","table-sm",2,"width","50%"],[1,"col-sm-12"],[1,"loading-shade"],[3,"salesOrder"]],template:function(r,a){1&r&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),t._uU(5),t.ALo(6,"translate"),t.qZA()()(),t.TgZ(7,"div",2),t.YNc(8,aa,4,3,"button",4),t.qZA()()(),t._UZ(9,"br"),t.YNc(10,Za,132,105,"ng-container",5),t.YNc(11,xa,2,1,"div",6),t.YNc(12,Ta,2,1,"ng-container",5)),2&r&&(t.xp6(5),t.AsE("",t.lcZ(6,6,"SALES_ORDER"),"#",null==a.salesOrder?null:a.salesOrder.orderNumber,""),t.xp6(3),t.Q6J("hasClaim","SO_GENERATE_INVOICE"),t.xp6(2),t.Q6J("ngIf",a.salesOrder),t.xp6(1),t.Q6J("ngIf",a.isLoading),t.xp6(1),t.Q6J("ngIf",a.salesOrderForInvoice))},dependencies:[m.mk,m.sg,m.O5,Y.d,H.Y,f.Ou,U.R,ra.D,G.M,N.X$,K.r],styles:[".total[_ngcontent-%COMP%]{text-align:end;border:1px solid #dee2e6;font-weight:700}.head[_ngcontent-%COMP%]{background-color:#ececec;text-align:center}"]}),e})();var Sa=s(4835);const va=[{path:"list",component:sr,data:{claimType:"SO_VIEW_SALES_ORDERS"},canActivate:[F.a]},{path:":id",component:Kr,data:{claimType:["SO_ADD_SO","SO_UPDATE_SO"]},canActivate:[F.a],resolve:{units:zr.l,warehouses:Sa.m,taxs:Wr.B,salesorder:Xr.D,products:ta.S}},{path:"detail/:id",component:Ca,data:{claimType:"SO_VIEW_SO_DETAIL"},canActivate:[F.a]}];let Ia=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[p.Bz.forChild(va),p.Bz]}),e})(),Ua=(()=>{class e{}return e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,Ia,c.u5,c.UX,et.m,rt.FA,D.XK,at.c,nt.lN,ot.Fk,M.LD,st.QW,d.p0,E.TU,x.JX,T.Tx,q.Ps,b.ot,y.Bb,f.Cq,O.Ll,O.x,it.p9,B.t]}),e})()}}]);